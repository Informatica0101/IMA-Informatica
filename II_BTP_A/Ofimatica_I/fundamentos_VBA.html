<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presentación: Fundamentos de VBA</title>
    <!-- CDN de Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; }
        html { font-size: 90%; }
        html, body { margin: 0; padding: 0; height: 100vh; width: 100vw; overflow-x: hidden; }
        body {
            display: flex;
            flex-direction: column;
            font-family: 'Inter', sans-serif;
            background-color: #f9fafb;
            color: #374151;
            justify-content: space-between;
        }
        #presentation-container {
            width: 100%;
            height: calc(100vh - 7rem); /* 7rem es la altura combinada del header y footer */
            position: relative;
            background-color: #ffffff;
            border-radius: 1rem;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
            max-width: 100vw;
            /* Transición para evitar saltos bruscos al salir de fullscreen */
            transition: all 0.3s ease;
        }

        .slide {
            width: 100%;
            height: 100%;
            padding: 1.8rem;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            transition: opacity 0.5s ease-in-out;
            position: absolute;
            top: 0;
            left: 0;
            opacity: 0;
            -ms-overflow-style: none;
            scrollbar-width: none;
            overflow-y: auto;
        }
        .slide::-webkit-scrollbar { display: none; }
        .slide.active {
            display: flex;
            opacity: 1;
            animation-name: fadeIn;
            animation-duration: 0.8s;
            animation-fill-mode: forwards;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(18px);}
            to { opacity: 1; transform: translateY(0);}
        }
        @media (max-width: 768px) {
            .slide h2, .slide h3 { font-size: 1.4rem; }
            .slide p, .slide li { font-size: 0.9rem; }
            .nav-button { padding: 0.4rem 0.8rem; font-size: 0.8rem; }
            .example-box { padding: 1rem; }
            .table-content th, .table-content td { padding: 0.5rem; font-size: 0.75rem; }
        }
        .quiz-option-button {
            transition: background-color 0.3s, transform 0.2s;
            text-align: left;
            padding-left: 1.5rem;
        }
        .quiz-option-button.correct {
            background-color: #d1fae5;
            color: #065f46;
            border-color: #10b981;
        }
        .quiz-option-button.incorrect {
            background-color: #fee2e2;
            color: #991b1b;
            border-color: #ef4444;
        }
        .section-header {
            font-size: 1.8rem;
            font-weight: 700;
            color: #6366f1;
            margin-bottom: 1rem;
        }
        .example-box {
            background-color: #f0f9ff;
            border-left: 5px solid #6366f1;
            padding: 1.5rem;
            border-radius: 0.5rem;
            text-align: left;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .content-image-style {
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px rgba(0,0,0,0.1);
            margin-top: 1.5rem;
        }
        .code-block {
            background-color: #1f2937;
            padding: 1.5rem;
            border-radius: 0.5rem;
            color: #e5e7eb;
            text-align: left;
            font-family: monospace;
            overflow-x: auto;
            max-width: 90%;
            margin: 1rem auto;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        .code-keyword { color: #facc15; } /* Amarillo */
        .code-object { color: #34d399; } /* Verde */
        .code-string { color: #f87171; } /* Rojo/Salmón */
        .code-comment { color: #9ca3af; } /* Gris */
        .code-property { color: #60a5fa; } /* Azul */
    </style>
</head>
<body class="antialiased">

    <!-- Header de la página -->
    <header id="page-header" class="w-full bg-white p-3 shadow-md flex flex-col sm:flex-row justify-center sm:justify-between items-center z-50 text-center sm:text-left">
        <div class="flex flex-col sm:flex-row items-center space-y-1 sm:space-y-0 sm:space-x-3">
            <img src="/imagenes/logo.png" alt="Logo de la institución" class="w-20 sm:w-28 h-auto">
            <h1 class="text-base sm:text-xl font-bold text-gray-800 mt-1 sm:mt-0">Fundamentos de Programación VBA</h1>
        </div>
        <nav class="mt-3 sm:mt-0 flex items-center space-x-3">
            <ul class="flex space-x-2 sm:space-x-3"><li><a href="#" class="text-gray-600 hover:text-indigo-500 transition-colors text-xs sm:text-sm">Inicio</a></li></ul>
        </nav>
    </header>

    <!-- Contenido principal de la presentación -->
    <main class="flex-grow flex justify-center items-center p-3">
        <div id="presentation-container" class="relative">

            <!-- Slide 1: Portada -->
            <div id="slide-1" class="slide active">
                <img src="/imagenes/logo.png" alt="Logo de la Institución" class="w-40 sm:w-56 md:w-72 h-auto mb-3 sm:mb-7">
                <h2 class="text-3xl sm:text-5xl mb-1 sm:mb-3 text-indigo-700 font-extrabold">FUNDAMENTOS DE VBA</h2>
                <div class="mt-5 sm:mt-10 text-base sm:text-xl text-gray-700 space-y-2">
                    <p>Asignatura: <b>Ofimática I</b></p>
                    <p>Grado: <b>Undécimo de Informática</b></p>
                </div>
                <div class="mt-7 sm:mt-10 text-sm sm:text-base text-gray-500">
                    <p>Docente: Pablo Antonio Peña</p>
                </div>
            </div>

            <!-- Slide 2: ¿Qué es VBA? -->
            <div id="slide-2" class="slide">
                <h3 class="section-header">1. ¿Qué es VBA?</h3>
                <div class="max-w-3xl text-left mx-auto">
                    <p class="text-sm sm:text-lg text-gray-700 leading-relaxed">
                        <b>Visual Basic for Applications (<code>VBA</code>)</b> es un lenguaje de programación orientado a eventos (POO) diseñado específicamente para extender y automatizar las aplicaciones de <code>Microsoft Office</code> (Excel, Access, Word).
                    </p>
                    <div class="example-box mt-6">
                        <p class="font-semibold text-indigo-700 mb-2">Su Propósito Principal: La Automatización</p>
                        <p class="text-gray-700">Sirve para crear <b>Macros</b>, que son secuencias de comandos para realizar tareas repetitivas automáticamente. Por ejemplo, generar un reporte con un solo clic.</p>
                    </div>
                </div>
            </div>

            <!-- Slide 3: El Entorno de VBA (VBE) -->
            <div id="slide-3" class="slide">
                <h3 class="section-header">2. El Entorno de Desarrollo (VBE)</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">
                    Es nuestra "área de trabajo". Aquí es donde escribimos y probamos el código <code>VBA</code>.
                </p>
                <img src="/imagenes/interfaz.PNG" alt="Esquema del Editor de VBA" class="max-w-xl mx-auto content-image-style">
                <ul class="list-disc list-inside text-left text-base text-gray-700 mt-6 space-y-2 max-w-2xl mx-auto">
                    <li><b>Acceso Rápido:</b> Presione <kbd>Alt + F11</kbd> en Excel para abrirlo.</li>
                    <li><b>Módulo:</b> Es el "documento" donde escribimos nuestro código. Se crea desde <code class="bg-gray-200 p-1 rounded">Insertar > Módulo</code>.</li>
                </ul>
            </div>

            <!-- Slide 4: Objeto, Propiedad, Método -->
            <div id="slide-4" class="slide">
                <h3 class="section-header">3. Objeto, Propiedad y Método</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">
                    VBA funciona como dar órdenes en español: necesitas un <b>sujeto</b>, un <b>atributo</b> y una <b>acción</b>.
                </p>
                <table class="table-content w-full max-w-2xl mx-auto mt-6 border-collapse shadow-lg rounded-lg overflow-hidden">
                    <thead class="bg-indigo-600 text-white">
                        <tr>
                            <th class="p-3">Elemento</th>
                            <th class="p-3">Analogía</th>
                            <th class="p-3">Ejemplo en VBA</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white text-gray-700">
                        <tr class="border-b">
                            <td class="p-3 font-semibold"><b>Objeto</b></td>
                            <td class="p-3">La "cosa" que quieres manipular (Sujeto).</td>
                            <td class="p-3"><code>Range("A1")</code> (La celda A1)</td>
                        </tr>
                        <tr class="bg-gray-50 border-b">
                            <td class="p-3 font-semibold"><b>Propiedad</b></td>
                            <td class="p-3">Una característica del objeto (Atributo).</td>
                            <td class="p-3"><code>.Value</code> (Su valor o contenido)</td>
                        </tr>
                        <tr>
                            <td class="p-3 font-semibold"><b>Método</b></td>
                            <td class="p-3">Una acción que el objeto puede hacer (Verbo).</td>
                            <td class="p-3"><code>.ClearContents</code> (Borrar contenido)</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Slide 5: Ejemplo Práctico de Objeto/Propiedad -->
            <div id="slide-5" class="slide">
                <h3 class="section-header">Ejemplo: Objeto y Propiedad</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">Para cambiar el valor de la celda A1, le decimos a VBA: "Quiero que la <b>Celda A1</b>, cambie su <b>valor</b> a 'Hola Mundo'".</p>
                <div class="code-block w-full max-w-2xl">
                    <pre>
<span class="code-comment">' Objeto.Propiedad = NuevoValor</span>
<span class="code-object">Range</span>(<span class="code-string">"A1"</span>).<span class="code-property">Value</span> = <span class="code-string">"Hola Mundo"</span>
                    </pre>
                </div>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mt-6">Aquí, <code>Range("A1")</code> es el objeto y <code>.Value</code> es la propiedad que estamos cambiando.</p>
            </div>

            <!-- Slide 6: Variables -->
            <div id="slide-6" class="slide">
                <h3 class="section-header">4. Variables: Guardando Información</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">Una <b>variable</b> es como una caja con un nombre donde podemos guardar datos temporalmente (como un texto o un número).</p>
                <div class="code-block w-full max-w-2xl">
                    <pre>
<span class="code-comment">' 1. Declaramos la "caja" con Dim</span>
<span class="code-keyword">Dim</span> <span class="code-object">saludo</span> <span class="code-keyword">As</span> <span class="code-object">String</span>

<span class="code-comment">' 2. Guardamos un texto en ella</span>
<span class="code-object">saludo</span> = <span class="code-string">"Bienvenido a VBA"</span>
                    </pre>
                </div>
                <ul class="list-disc list-inside text-left text-base text-gray-700 mt-6 space-y-2 max-w-2xl mx-auto">
                    <li><code>Dim</code> es la palabra clave para "declarar" o crear una variable.</li>
                    <li><code>String</code> es el tipo de dato para guardar texto.</li>
                </ul>
            </div>

            <!-- Slide 7: MsgBox -->
            <div id="slide-7" class="slide">
                <h3 class="section-header">5. Interactuando con el Usuario: <code>MsgBox</code></h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">La función <code>MsgBox</code> es la forma más sencilla de mostrar un mensaje emergente al usuario.</p>
                <div class="code-block w-full max-w-2xl">
                    <pre>
<span class="code-comment">' Muestra un cuadro de mensaje simple</span>
<span class="code-object">MsgBox</span> <span class="code-string">"¡Mi primera macro funciona!"</span>
                    </pre>
                </div>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mt-6">También podemos mostrar el contenido de una variable.</p>
                <div class="code-block w-full max-w-2xl">
                    <pre>
<span class="code-keyword">Dim</span> <span class="code-object">saludo</span> <span class="code-keyword">As</span> <span class="code-object">String</span>
<span class="code-object">saludo</span> = <span class="code-string">"Bienvenido a VBA"</span>
<span class="code-object">MsgBox</span> <span class="code-object">saludo</span>
                    </pre>
                </div>
            </div>

            <!-- Slide 8: Tu Primer Macro -->
            <div id="slide-8" class="slide">
                <h3 class="section-header">6. Tu Primer Macro: "Hola Mundo"</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">Todo el código VBA se escribe dentro de un procedimiento que empieza con <code>Sub</code> y termina con <code>End Sub</code>.</p>
                <div class="code-block w-full max-w-2xl">
                    <pre>
<span class="code-keyword">Sub</span> <span class="code-object">Saludar</span>()
    <span class="code-comment">' Este código se ejecutará cuando corras la macro "Saludar"</span>

    <span class="code-comment">' Escribe en la celda A1</span>
    <span class="code-object">Range</span>(<span class="code-string">"A1"</span>).<span class="code-property">Value</span> = <span class="code-string">"¡Hola desde VBA!"</span>

    <span class="code-comment">' Muestra un mensaje de confirmación</span>
    <span class="code-object">MsgBox</span> <span class="code-string">"Macro ejecutada con éxito."</span>

<span class="code-keyword">End Sub</span>
                    </pre>
                </div>
            </div>

            <!-- Slide 9: Cómo Ejecutar una Macro (NUEVA) -->
            <div id="slide-9" class="slide">
                <h3 class="section-header">7. Cómo Ejecutar tu Macro</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">Una vez escrito el código, hay varias formas de ponerlo en marcha:</p>
                <ul class="list-disc list-inside text-left text-base text-gray-700 mt-6 space-y-3 max-w-2xl mx-auto">
                    <li><b>Desde el Editor (F5):</b> Con el cursor dentro de tu <code>Sub</code>, presiona la tecla <kbd>F5</kbd>. Es la forma más rápida para probar.</li>
                    <li><b>Desde el Diálogo de Macros (Alt+F8):</b> En Excel, presiona <kbd>Alt + F8</kbd>, selecciona tu macro de la lista y haz clic en "Ejecutar".</li>
                    <li><b>Con un Botón:</b> Puedes insertar una forma (ej. un rectángulo) en tu hoja de Excel, hacer clic derecho sobre ella y seleccionar "Asignar macro...".</li>
                </ul>
                <img src="/imagenes/macros.PNG" alt="Diálogo de Macros en Excel" class="max-w-md mx-auto content-image-style mt-4">
            </div>

            <!-- Slide 10: Guardando el Libro (NUEVA) -->
            <div id="slide-10" class="slide">
                <h3 class="section-header">8. ¡Importante! Guardar tu Trabajo</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">
                    Para que tu código VBA se guarde, el libro de Excel <strong>DEBE</strong> ser guardado en un formato especial.
                </p>
                <div class="example-box bg-red-50 border-red-500">
                    <p class="font-semibold text-red-700 mb-2">Formato Requerido: Libro de Excel habilitado para macros (*.xlsm)</p>
                    <p class="text-gray-700">Si lo guardas como un libro normal (`.xlsx`), ¡todo tu código VBA se borrará sin advertencia!</p>
                </div>
                <img src="/imagenes/dialogo.PNG" alt="Diálogo de Guardar Como en Excel mostrando el formato .xlsm" class="max-w-xl mx-auto content-image-style mt-4">
            </div>

            <!-- Slide 11: Quiz -->
            <div id="slide-11" class="slide">
                <h3 class="section-header">9. ¡Pon a prueba tus conocimientos!</h3>
                <div id="quiz-container" class="bg-gray-100 p-3 sm:p-7 rounded-lg shadow-md max-w-3xl w-full text-center">
                    <div id="quiz-question" class="text-base sm:text-xl font-semibold mb-2 sm:mb-5 text-gray-800"></div>
                    <div id="quiz-options" class="flex flex-col space-y-2 sm:space-y-3"></div>
                    <div id="quiz-feedback" class="mt-3 sm:mt-5 text-sm sm:text-base font-bold"></div>
                </div>
            </div>

            <!-- Slide 12: Asignación Práctica (NUEVA) -->
            <div id="slide-12" class="slide">
                <h3 class="section-header">10. Asignación Práctica</h3>
                <p class="text-sm sm:text-lg text-gray-700 leading-relaxed max-w-3xl mb-6">
                    Abre un nuevo libro de Excel, ve al editor de VBA (<kbd>Alt + F11</kbd>), inserta un módulo y escribe la siguiente macro:
                </p>
                <div class="example-box max-w-2xl mx-auto">
                    <p class="font-semibold text-indigo-700 mb-3">Tarea: Macro de Presentación</p>
                    <p class="text-gray-700">Crea una macro llamada <code>MiPresentacion</code> que haga lo siguiente:</p>
                    <ol class="list-decimal list-inside ml-4 text-gray-700 mt-2 space-y-2">
                        <li>Escriba tu nombre completo en la celda <strong>B2</strong>.</li>
                        <li>Escriba la fecha de hoy en la celda <strong>B3</strong> (Pista: usa la función <code>Date</code>).</li>
                        <li>Muestre un <code>MsgBox</code> que diga "Tarea completada".</li>
                    </ol>
                    <p class="text-gray-700 mt-4">Finalmente, guarda el libro como <strong>"Tarea1_TuNombre.xlsm"</strong> y ejecútala.</p>
                </div>
            </div>

            <!-- Slide 13: Gracias -->
            <div id="slide-13" class="slide">
                <h3 class="section-header">¡Gracias!</h3>
                <p class="text-2xl sm:text-3xl text-gray-700 font-semibold mt-4 max-w-3xl">
                    ¡Ahora tienes las herramientas para empezar a automatizar en Excel!
                </p>
                <p class="text-lg sm:text-xl text-indigo-600 mt-8">
                    ¿Preguntas?
                </p>
                <img src="/imagenes/logo.png" alt="Logo de la Institución" class="w-24 sm:w-32 h-auto mt-10">
            </div>

        </div>
    </main>

    <!-- Pie de página (Ahora incluye navegación) -->
    <footer id="page-footer" class="w-full bg-gray-800 text-white text-center text-xs p-2 flex flex-col items-center justify-center">
        <!-- Contenido principal del footer -->
        <div class="flex flex-col sm:flex-row items-center justify-center space-y-1 sm:space-y-0 sm:space-x-4">
            <img src="/imagenes/bandera-de-honduras.png" alt="Bandera de Honduras" class="w-14 sm:w-16 h-auto">
            <p class="text-sm">Ofimática I | Undécimo de Informática | © <span id="current-year"></span> Instituto María Auxiliadora, Sistema ISEMED.</p>
        </div>

        <!-- Controles de Navegación integrados en el footer -->
        <div class="flex items-center justify-center space-x-4 mt-2 mb-1">
            <button id="prev-btn" class="nav-button bg-indigo-500 hover:bg-indigo-600 text-white rounded-full px-4 py-2 text-xs transition-colors shadow-md">Anterior</button>
            <div id="slide-counter" class="font-semibold text-white text-sm">1 / 13</div>
            <button id="next-btn" class="nav-button bg-indigo-500 hover:bg-indigo-600 text-white rounded-full px-4 py-2 text-xs transition-colors shadow-md">Siguiente</button>
        </div>
    </footer>

    <!-- Scripts para la navegación, el quiz y la funcionalidad de pantalla completa -->
    <script>
        window.addEventListener('unhandledrejection', (event) => {
            console.error('Unhandled promise rejection:', event.reason);
            event.preventDefault();
        });

        const slides = document.querySelectorAll('.slide');
        const nextButton = document.getElementById('next-btn');
        const prevButton = document.getElementById('prev-btn');
        const slideCounter = document.getElementById('slide-counter');
        const header = document.getElementById('page-header');
        const footer = document.getElementById('page-footer');
        let currentSlideIndex = 0;
        let isTransitioning = false;

        // Quiz de VBA Fundamental
        const quizQuestions = [
            {
                question: "En Range(\"A1\").Value = \"Hola\", ¿qué es '.Value'?",
                options: ["Un Objeto", "Una Propiedad", "Un Método"],
                correctAnswer: "Una Propiedad"
            },
            {
                question: "¿Para qué sirve el comando 'MsgBox'?",
                options: ["Para escribir en una celda", "Para guardar un valor", "Para mostrar un mensaje al usuario"],
                correctAnswer: "Para mostrar un mensaje al usuario"
            },
            {
                question: "Todo el código de una macro se escribe entre...",
                options: [
                    "Sub...End Sub",
                    "Start...End",
                    "Begin...Finish",
                    "Function...End Function"
                ],
                correctAnswer: "Sub...End Sub"
            }
        ];
        let currentQuizQuestionIndex = 0;

        function updateQuizDisplay() {
            const quizQuestionElement = document.getElementById('quiz-question');
            const quizOptionsElement = document.getElementById('quiz-options');
            const quizFeedbackElement = document.getElementById('quiz-feedback');
            const totalSlides = slides.length;

            if (currentQuizQuestionIndex >= quizQuestions.length) {
                quizQuestionElement.textContent = "¡Cuestionario completado! ¡Excelente trabajo!";
                quizOptionsElement.innerHTML = '';
                quizFeedbackElement.textContent = '';
                return;
            }

            const currentQuestion = quizQuestions[currentQuizQuestionIndex];
            quizQuestionElement.textContent = `Pregunta ${currentQuizQuestionIndex + 1}: ${currentQuestion.question}`;
            quizOptionsElement.innerHTML = '';
            quizFeedbackElement.textContent = '';
            currentQuestion.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.className = "quiz-option-button w-full px-5 py-2 rounded-xl border border-indigo-400 bg-indigo-50 text-indigo-700 font-semibold transition-colors duration-200 hover:bg-indigo-100 text-sm";
                button.onclick = () => checkAnswer(option);
                quizOptionsElement.appendChild(button);
            });
             updateSlideCounter(); // Actualiza el contador al estado actual del quiz
        }

        function checkAnswer(selectedOption) {
            const currentQuestion = quizQuestions[currentQuizQuestionIndex];
            const quizFeedback = document.getElementById('quiz-feedback');
            const buttons = document.querySelectorAll('#quiz-options .quiz-option-button');
            const isCorrect = selectedOption === currentQuestion.correctAnswer;
            buttons.forEach(button => {
                button.disabled = true;
                if (button.textContent === currentQuestion.correctAnswer) {
                    button.classList.add('correct');
                } else if (button.textContent === selectedOption) {
                    button.classList.add('incorrect');
                }
            });
            if (isCorrect) {
                quizFeedback.textContent = '¡Correcto!';
                quizFeedback.classList.remove('text-red-500');
                quizFeedback.classList.add('text-green-500');
            } else {
                quizFeedback.textContent = 'Incorrecto. La respuesta correcta es: ' + currentQuestion.correctAnswer;
                quizFeedback.classList.remove('text-green-500');
                quizFeedback.classList.add('text-red-500');
            }
            setTimeout(() => {
                currentQuizQuestionIndex++;
                updateQuizDisplay();
            }, 2500);
        }

        // --- LÓGICA DE NAVEGACIÓN ---
        function updateSlideCounter() {
            slideCounter.textContent = `${currentSlideIndex + 1} / ${slides.length}`;
        }
        function updateNavigationButtons() {
            prevButton.disabled = currentSlideIndex === 0;
            nextButton.disabled = currentSlideIndex === slides.length - 1;
        }
        function showSlide(index) {
            if (isTransitioning || index < 0 || index >= slides.length) {
                return;
            }
            isTransitioning = true;
            slides.forEach((slide) => {
                slide.classList.remove('active');
                slide.style.display = 'none';
            });
            currentSlideIndex = index;
            // Si es la diapositiva del Quiz (ahora índice 10), reiniciamos el cuestionario
            if (currentSlideIndex === 10) {
                currentQuizQuestionIndex = 0;
                updateQuizDisplay();
            }
            const activeSlide = slides[currentSlideIndex];
            activeSlide.style.display = 'flex';
            setTimeout(() => {
                activeSlide.classList.add('active');
                updateSlideCounter();
                updateNavigationButtons();
                isTransitioning = false;
            }, 10);
        }
        nextButton.addEventListener('click', () => {
            showSlide(currentSlideIndex + 1);
        });
        prevButton.addEventListener('click', () => {
            showSlide(currentSlideIndex - 1);
        });
        document.addEventListener('keydown', (event) => {
            if (event.key === 'ArrowRight') {
                showSlide(currentSlideIndex + 1);
            } else if (event.key === 'ArrowLeft') {
                showSlide(currentSlideIndex - 1);
            }
        });

        // Nueva lógica para ocultar/mostrar header y footer con F11
        document.addEventListener('keydown', (event) => {
            if (event.key === 'F11') {
                // event.preventDefault(); // Se elimina para permitir la pantalla completa nativa
                const isHidden = header.style.display === 'none';
                header.style.display = isHidden ? 'flex' : 'none';
                footer.style.display = isHidden ? 'flex' : 'none';
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const currentYearSpan = document.getElementById('current-year');
            if (currentYearSpan) {
                currentYearSpan.textContent = new Date().getFullYear();
            }
            showSlide(0);
        });
    </script>
</body>
</html>
