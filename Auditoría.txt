AUDITORÍA INICIAL - 18/01/2026
-------------------------------------------------------------------
- Archivo: student-dashboard.html
  - Línea(s): 134-142 (Input de archivo)
  - Hallazgo: El input de archivo solo acepta imágenes (accept="image/*") y es único. Se requiere soportar PDF y DOCX, y permitir la subida de múltiples archivos uno por uno.
  - Hallazgo: El modal de entrega carece de un área de previsualización de imágenes y de una lista de archivos ya subidos en segundo plano.

- Archivo: js/student.js
  - Línea(s): 110-141 (Manejo de envío de tarea)
  - Hallazgo: La función actual lee el archivo como DataURL y lo envía todo junto. Se requiere desacoplar la subida del archivo de la confirmación final de la tarea.
  - Hallazgo: Falta lógica para manejar subidas en segundo plano, previsualización y seguimiento de múltiples IDs de archivos.

- Archivo: backend/task-service/Code.gs
  - Línea(s): 114-144 (Función submitAssignment)
  - Hallazgo: La función submitAssignment crea un archivo y registra la entrega en una sola operación. Se requiere una nueva acción (uploadFile) para subir archivos individualmente y devolver su ID.
  - Hallazgo: La lógica de submitAssignment debe actualizarse para aceptar ya sea un ID de archivo único o un ID de carpeta (si hay múltiples archivos).
  - Hallazgo: Se debe asegurar que si hay más de una imagen, se devuelva el enlace de la carpeta pública.

- Archivo: js/teacher.js
  - Línea(s): 87-120 (Renderizado de actividad)
  - Hallazgo: La lógica de renderizado asume que fileId es siempre un archivo. Si es una carpeta, el lightbox o el enlace de descarga fallarán. Se requiere distinguir entre archivo y carpeta (MIME type 'folder' o similar).

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 2-3
- Tipo de problema: Arquitectura, Configuración
- Descripción detallada del problema: Los IDs de la hoja de cálculo (SPREADSHEET_ID) y la carpeta de Drive (DRIVE_FOLDER_ID) están hardcodeados como constantes globales.
- Impacto potencial: Si se necesita cambiar la hoja de cálculo o la carpeta de destino (por ejemplo, para un entorno de pruebas o una nueva versión), es necesario modificar el código fuente y volver a desplegar el script. Esto aumenta el riesgo de errores y dificulta la gestión de la configuración.
- Dependencias afectadas: Todas las funciones que dependen de `ss` o `DRIVE_FOLDER_ID`.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: doPost
- Línea(s) involucrada(s): 74-75
- Tipo de problema: Seguridad, Manejo de Errores
- Descripción detallada del problema: El bloque `catch` general captura cualquier error y devuelve su mensaje directamente al cliente a través de `error.toString()`.
- Impacto potencial: Esto puede exponer detalles sensibles de la implementación interna, trazas de pila (stack traces) o mensajes de error del sistema (ej. "Límite de tiempo de ejecución de Apps Script excedido") que podrían ser utilizados por un atacante para entender mejor la arquitectura del backend.
- Dependencias afectadas: Todas las llamadas de cliente desde el frontend.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: registerUser
- Línea(s) involucrada(s): 81-83
- Tipo de problema: Seguridad
- Descripción detallada del problema: La contraseña se hashea usando SHA-256 pero sin la adición de un "salt" (una cadena aleatoria única para cada usuario).
- Impacto potencial: Si la base de datos de usuarios se viera comprometida, un atacante podría usar tablas precalculadas (rainbow tables) para encontrar las contraseñas originales de forma mucho más eficiente.
- Dependencias afectadas: Flujo de registro y autenticación.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: registerUser
- Línea(s) involucrada(s): 80
- Tipo de problema: Robustez
- Descripción detallada del problema: El ID de usuario se genera usando `new Date().getTime()`.
- Impacto potencial: Aunque es poco probable, si dos usuarios se registran en el mismo milisegundo, podrían obtener el mismo ID, causando colisiones de datos y comportamiento inesperado. No garantiza unicidad absoluta.
- Dependencias afectadas: Cualquier lógica que dependa de la unicidad del `userId`.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: registerUser
- Línea(s) involucrada(s): 79
- Tipo de problema: Validación
- Descripción detallada del problema: La función no valida que los campos del `payload` (nombre, grado, seccion, email, password) no estén vacíos, nulos o que tengan un formato adecuado (ej. email válido).
- Impacto potencial: Se pueden insertar en la base de datos (Google Sheet) registros incompletos o con datos malformados, lo que podría causar errores en otras partes de la aplicación (ej. en el login, al crear carpetas en Drive, etc.).
- Dependencias afectadas: Hoja `Usuarios`, funciones `loginUser`, `submitAssignment`.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: registerUser
- Línea(s) involucrada(s): 85
- Tipo de problema: Lógico, Validación
- Descripción detallada del problema: No se verifica si ya existe un usuario registrado con el mismo `email` antes de insertar la nueva fila.
- Impacto potencial: Permite la creación de múltiples cuentas con el mismo correo electrónico, lo que puede causar confusión en el login, ya que la función `loginUser` devolverá la primera cuenta que encuentre.
- Dependencias afectadas: Hoja `Usuarios`, función `loginUser`.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: loginUser
- Línea(s) involucrada(s): 92-93
- Tipo de problema: Rendimiento
- Descripción detallada del problema: La función carga la hoja completa de `Usuarios` en memoria (`getDataRange().getValues()`) y luego itera sobre todas las filas para encontrar una coincidencia.
- Impacto potencial: A medida que el número de usuarios crezca, esta operación se volverá cada vez más lenta, pudiendo exceder los límites de tiempo de ejecución de Google Apps Script y haciendo que el login falle o sea muy lento para todos.
- Dependencias afectadas: Flujo de login.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: createTask
- Línea(s) involucrada(s): 112
- Tipo de problema: Validación
- Descripción detallada del problema: La función no realiza ninguna validación sobre los datos del `payload` antes de crear la tarea.
- Impacto potencial: Se pueden crear tareas con campos vacíos (título, descripción, etc.) o con formatos de fecha incorrectos, afectando la visualización y funcionalidad en el dashboard del estudiante.
- Dependencias afectadas: Hoja `Tareas`, función `getStudentTasks`.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: getStudentTasks
- Línea(s) involucrada(s): 119-120
- Tipo de problema: Rendimiento
- Descripción detallada del problema: La función carga la totalidad de las hojas `Tareas` y `Entregas` en memoria para luego filtrarlas en el script.
- Impacto potencial: Con un gran número de tareas y entregas, la función se volverá muy lenta, pudiendo causar timeouts y una mala experiencia de usuario en el dashboard del estudiante.
- Dependencias afectadas: Dashboard del estudiante.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: submitAssignment
- Línea(s) involucrada(s): 161, 166
- Tipo de problema: Rendimiento
- Descripción detallada del problema: Para encontrar el usuario y la tarea, la función carga las hojas completas (`Usuarios`, `Tareas`) y utiliza el método `.find()`.
- Impacto potencial: Esta operación es ineficiente y contribuirá a la ralentización del proceso de entrega de tareas a medida que los datos crezcan.
- Dependencias afectadas: Proceso de entrega de tareas.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: submitAssignment
- Línea(s) involucrada(s): 180
- Tipo de problema: Robustez
- Descripción detallada del problema: La extracción del tipo MIME del archivo se basa en una expresión regular (`match(/:(.*?);/)`) que asume un formato específico para la cadena base64.
- Impacto potencial: Si el frontend envía la cadena con un formato ligeramente diferente (ej. sin punto y coma), la expresión fallará con un error de "cannot read properties of null", rompiendo la subida de archivos.
- Dependencias afectadas: Proceso de entrega de tareas.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: getTeacherActivity
- Línea(s) involucrada(s): 193-197, 212
- Tipo de problema: Rendimiento
- Descripción detallada del problema: La función carga 5 hojas de cálculo completas en memoria (`Usuarios`, `Tareas`, `Examenes`, `Entregas`, `EntregasExamen`) para realizar operaciones de "join" y agregación de datos.
- Impacto potencial: Es la función con el peor rendimiento del script. Con una cantidad moderada de datos, es casi seguro que excederá los límites de tiempo de ejecución de Apps Script, haciendo que el dashboard del profesor no cargue.
- Dependencias afectadas: Dashboard del profesor.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: getTeacherActivity
- Línea(s) involucrada(s): 230
- Tipo de problema: Lógica, Localización
- Descripción detallada del problema: La fecha de la actividad se formatea usando `item.fecha.toLocaleString()`.
- Impacto potencial: Esto utiliza la configuración regional (locale) del servidor de Google para formatear la fecha y hora, que puede no coincidir con la del usuario final, mostrando fechas en un formato inesperado o incorrecto para el profesor.
- Dependencias afectadas: Dashboard del profesor.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: reactivateExam
- Línea(s) involucrada(s): 238
- Tipo de problema: Mantenibilidad
- Descripción detallada del problema: El estado del examen se actualiza usando un índice de columna hardcodeado (`getRange(i + 1, 7)`). El número `7` es un "número mágico".
- Impacto potencial: Si un desarrollador añade, elimina o reordena una columna en la hoja `EntregasExamen`, esta función fallará silenciosamente o, peor aún, modificará la columna incorrecta, corrompiendo los datos.
- Dependencias afectadas: Hoja `EntregasExamen`.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: gradeSubmission
- Línea(s) involucrada(s): 248-250
- Tipo de problema: Mantenibilidad
- Descripción detallada del problema: Las columnas para calificación, estado y comentario se actualizan usando índices hardcodeados (`6`, `7`, `8`).
- Impacto potencial: Similar al problema en `reactivateExam`, cualquier cambio en la estructura de la hoja `Entregas` romperá esta funcionalidad, llevando a una posible corrupción de datos.
- Dependencias afectadas: Hoja `Entregas`.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: createExam
- Línea(s) involucrada(s): 369
- Tipo de problema: Robustez
- Descripción detallada del problema: El ID de la pregunta se genera con `new Date().getTime() + Math.random()`.
- Impacto potencial: Aunque la probabilidad de colisión es extremadamente baja, no es criptográficamente imposible generar el mismo ID dos veces, especialmente si la función se ejecuta muy rápidamente en sucesión. No garantiza unicidad.
- Dependencias afectadas: Creación y entrega de exámenes.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: submitExam
- Línea(s) involucrada(s): 353
- Tipo de problema: Lógica, Funcionalidad Incompleta
- Descripción detallada del problema: Un comentario en el código (`// Tipos 'termino_pareado' y 'respuesta_breve' se omiten de la calificación automática por simplicidad.`) indica explícitamente que ciertos tipos de preguntas no se califican.
- Impacto potencial: La calificación final del examen será incorrecta si incluye estos tipos de preguntas, ya que no se contarán para la nota. La funcionalidad no cumple con lo que un usuario esperaría.
- Dependencias afectadas: Proceso de entrega de exámenes.

- Archivo: backend.gs
- Ruta completa: /backend.gs
- Función / método / bloque afectado: submitExam
- Línea(s) involucrada(s): 362
- Tipo de problema: Robustez, Manejo de Errores
- Descripción detallada del problema: La calificación se calcula con `(correctas / preguntasDelExamen.length) * 100`. Si un examen no tuviera preguntas (`preguntasDelExamen.length` es 0), esto resultaría en una división por cero.
- Impacto potencial: Una división por cero en JavaScript produce `Infinity` o `NaN`, lo cual podría causar un error al intentar guardar este valor en la hoja de cálculo o al procesarlo en el frontend, rompiendo el flujo de entrega del examen.
- Dependencias afectadas: Proceso de entrega de exámenes.
- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: Global <head>
- Línea(s) involucrada(s): 7
- Tipo de problema: Dependencia Externa, Rendimiento
- Descripción detallada del problema: El archivo carga Tailwind CSS desde una CDN (`https://cdn.tailwindcss.com`).
- Impacto potencial: Esto crea una dependencia en un servicio externo. Si la CDN está lenta o no disponible, el sitio no se renderizará correctamente. Además, carga la librería completa de Tailwind, que puede ser muy grande y contener muchos estilos no utilizados, afectando negativamente el tiempo de carga de la página (Page Load Time).
- Dependencias afectadas: Renderizado visual de toda la página.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: Global <head>
- Línea(s) involucrada(s): 8
- Tipo de problema: Dependencia Externa, Rendimiento
- Descripción detallada del problema: El archivo carga Google Fonts desde su CDN (`https://fonts.googleapis.com`).
- Impacto potencial: Similar a la CDN de Tailwind, crea una dependencia externa. Si el servicio de Google Fonts falla o es bloqueado, la tipografía del sitio no se cargará, afectando el diseño. Representa una solicitud de red adicional que puede ralentizar la carga inicial.
- Dependencias afectadas: Tipografía de toda la página.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: <style> block
- Línea(s) involucrada(s): 9-195
- Tipo de problema: Mantenibilidad, Organización
- Descripción detallada del problema: Hay un bloque grande de CSS personalizado (`<style>`) directamente en el archivo HTML.
- Impacto potencial: Mezclar CSS con HTML dificulta el mantenimiento. Estos estilos no pueden ser cacheados por el navegador de forma independiente al archivo HTML, lo que significa que se vuelven a descargar con cada visita a la página. dificulta la reutilización de estos estilos en otras páginas.
- Dependencias afectadas: Estilos de la página principal.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: <a> tags para pseudocódigo y contacto
- Línea(s) involucrada(s): 242, 273
- Tipo de problema: Funcionalidad, Enlace Roto
- Descripción detallada del problema: El enlace para "Pseudocódigo" en el menú móvil apunta a `pseudocode.js` (`href="pseudocode.js"`) en lugar de `pseudocode.html`. El enlace en el menú de escritorio sí apunta correctamente a `pseudocode.html`.
- Impacto potencial: Los usuarios que intenten acceder a la sección de pseudocódigo desde el menú móvil no podrán hacerlo, ya que el navegador intentará navegar a un archivo JavaScript en lugar de a la página HTML correspondiente.
- Dependencias afectadas: Navegación del sitio en dispositivos móviles.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: Global <script>
- Línea(s) involucrada(s): 412, 494, 574
- Tipo de problema: Mantenibilidad, Arquitectura
- Descripción detallada del problema: Los datos que definen la estructura de los menús y el contenido descargable (`presentationData`, `additionalResourcesData`, `downloadContentData`) están hardcodeados como objetos JavaScript directamente en el archivo HTML.
- Impacto potencial: Para agregar, eliminar o modificar cualquier curso, tema o recurso, es necesario editar el archivo `index.html`. Esto es propenso a errores (ej. un error de sintaxis en el JSON podría romper la página) y mezcla la capa de datos con la de presentación, dificultando la gestión del contenido.
- Dependencias afectadas: Toda la generación de menús de navegación y listas de descargas.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: Global <script>
- Línea(s) involucrada(s): 412-1110
- Tipo de problema: Mantenibilidad, Rendimiento
- Descripción detallada del problema: Todo el código JavaScript de la página (lógica de menús, transiciones, carga de contenido, etc.) se encuentra en un único y gran bloque `<script>` al final del `<body>`.
- Impacto potencial: Esto hace que el código sea difícil de leer, depurar y mantener. No puede ser cacheado por el navegador de forma independiente, por lo que se vuelve a descargar y a parsear en cada visita. Impide la reutilización de funciones en otras páginas.
- Dependencias afectadas: Toda la interactividad de la página.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: renderDesktopNav, renderMobileNav
- Línea(s) involucrada(s): 768-963
- Tipo de problema: Duplicación de código
- Descripción detallada del problema: Existen dos funciones separadas (`renderDesktopNav` y `renderMobileNav`) que iteran sobre las mismas estructuras de datos (`presentationData`, `additionalResourcesData`) para construir el HTML de los menús. Aunque el HTML resultante es diferente, la lógica de iteración y la estructura son muy similares.
- Impacto potencial: Si se necesita cambiar la lógica de cómo se procesan los datos (ej. agregar un nuevo tipo de recurso), el cambio debe realizarse en dos lugares diferentes, lo que aumenta la probabilidad de introducir inconsistencias.
- Dependencias afectadas: Menús de navegación de escritorio y móvil.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: loadPeripheralsGame, loadWebMasterQuiz, loadDexterityGame
- Línea(s) involucrada(s): 1205-1296
- Tipo de problema: Duplicación de código
- Descripción detallada del problema: Las tres funciones que cargan juegos (`loadPeripheralsGame`, `loadWebMasterQuiz`, `loadDexterityGame`) son casi idénticas. Comparten la misma lógica para: ocultar el header, ocultar las secciones de contenido principal, mostrar el contenedor del juego, actualizar el título, y manejar errores. La única diferencia real son las URLs de los archivos `.html` y `.js` y la función de inicialización que se llama.
- Impacto potencial: Dificulta el mantenimiento. Si se necesita cambiar la forma en que se cargan los juegos (por ejemplo, para agregar una pantalla de carga), el cambio debe replicarse en tres funciones distintas.
- Dependencias afectadas: Funcionalidad de carga de juegos interactivos.

- Archivo: index.html
- Ruta completa: /index.html
- Función / método / bloque afectado: gameDataStorage
- Línea(s) involucrada(s): 1162-1202
- Tipo de problema: Seguridad, Privacidad
- Descripción detallada del problema: El progreso de los juegos se guarda en `localStorage`.
- Impacto potencial: `localStorage` es específico del navegador y del dispositivo, por lo que el progreso de un usuario no persistirá si cambia de navegador o de computadora. Además, los datos en `localStorage` pueden ser leídos y modificados fácilmente por el usuario o por cualquier otro script en la página (riesgo de XSS), por lo que no es un lugar seguro para almacenar datos si en el futuro se quisiera dar puntos o calificaciones.
- Dependencias afectadas: Persistencia de datos de los juegos.
- Archivo: login.html
- Ruta completa: /login.html
- Función / método / bloque afectado: Global <head>
- Línea(s) involucrada(s): 6
- Tipo de problema: Dependencia Externa, Rendimiento
- Descripción detallada del problema: El archivo carga Tailwind CSS desde una CDN (`https://cdn.tailwindcss.com`), al igual que `index.html`.
- Impacto potencial: Crea una dependencia externa que puede fallar y ralentiza el tiempo de carga al incluir estilos no utilizados. No se aprovecha el cache del navegador entre páginas si el recurso es el mismo.
- Dependencias afectadas: Renderizado visual de la página de login.

- Archivo: login.html
- Ruta completa: /login.html
- Función / método / bloque afectado: <body>
- Línea(s) involucrada(s): 8
- Tipo de problema: Accesibilidad, Estructura
- Descripción detallada del problema: El contenido principal de la página no está envuelto en una etiqueta semántica como `<main>`.
- Impacto potencial: Puede dificultar la navegación para tecnologías de asistencia (como lectores de pantalla) que utilizan estas etiquetas para identificar el contenido principal de una página, ignorando encabezados o pies de página.
- Dependencias afectadas: Accesibilidad de la página.

- Archivo: login.html
- Ruta completa: /login.html
- Función / método / bloque afectado: <form>
- Línea(s) involucrada(s): 10-21
- Tipo de problema: Experiencia de Usuario, Manejo de Errores
- Descripción detallada del problema: El formulario de login no tiene un área designada para mostrar mensajes de error al usuario (ej. "Credenciales incorrectas", "El servidor no responde"). La retroalimentación se maneja a través de `alert()`, que es disruptivo.
- Impacto potencial: Una mala experiencia de usuario. `alert()` bloquea la interacción con la página y es visualmente inconsistente con el diseño. Si el script `auth.js` fallara, el usuario no recibiría ninguna indicación de lo que salió mal.
- Dependencias afectadas: `js/auth.js`.

- Archivo: login.html
- Ruta completa: /login.html
- Función / método / bloque afectado: <script> tags
- Línea(s) involucrada(s): 26-27
- Tipo de problema: Rendimiento, Mantenibilidad
- Descripción detallada del problema: Los scripts `config.js` y `auth.js` se cargan al final del `<body>`.
- Impacto potencial: Aunque cargar scripts al final del body es una práctica común para no bloquear el renderizado, estos scripts no tienen el atributo `defer` o `async`. Si los scripts fueran grandes, podrían retrasar el evento `DOMContentLoaded`. Además, si el número de scripts crece, su gestión dentro del HTML se vuelve más compleja.
- Dependencias afectadas: Ejecución del login.
- Archivo: register.html
- Ruta completa: /register.html
- Función / método / bloque afectado: Global <head>
- Línea(s) involucrada(s): 6
- Tipo de problema: Dependencia Externa, Rendimiento
- Descripción detallada del problema: El archivo carga Tailwind CSS desde una CDN (`https://cdn.tailwindcss.com`), replicando el mismo problema que `index.html` y `login.html`.
- Impacto potencial: Dependencia de un servicio externo propenso a fallos y carga de estilos innecesarios que afectan el rendimiento.
- Dependencias afectadas: Renderizado visual de la página de registro.

- Archivo: register.html
- Ruta completa: /register.html
- Función / método / bloque afectado: <select id="grado">
- Línea(s) involucrada(s): 24-28
- Tipo de problema: Mantenibilidad, Duplicación de Lógica
- Descripción detallada del problema: Las opciones para el campo "Grado" (`Décimo`, `Undécimo`, `Duodécimo`) están hardcodeadas directamente en el HTML.
- Impacto potencial: Si se necesita agregar o cambiar un grado, este cambio debe hacerse no solo aquí, sino en cualquier otra parte de la aplicación donde se utilice esta lógica (por ejemplo, en los formularios del profesor), lo que puede llevar a inconsistencias.
- Dependencias afectadas: Formulario de registro, consistencia de datos de grado en la aplicación.

- Archivo: register.html
- Ruta completa: /register.html
- Función / método / bloque afectado: <input type="text" id="seccion">
- Línea(s) involucrada(s): 32
- Tipo de problema: Usabilidad, Integridad de Datos
- Descripción detallada del problema: El campo "Sección" es un campo de texto libre (`<input type="text">`).
- Impacto potencial: Los usuarios pueden introducir la sección de múltiples maneras (ej. "A", "a", "Sección A", "seccion a"), lo que lleva a inconsistencias en la base de datos. Esto puede causar problemas al filtrar tareas o exámenes por sección. No es un campo requerido, lo cual podría ser un problema si la sección es obligatoria.
- Dependencias afectadas: Hoja `Usuarios`, lógica de filtrado de tareas/exámenes por sección.

- Archivo: register.html
- Ruta completa: /register.html
- Función / método / bloque afectado: <form>
- Línea(s) involucrada(s): 12-42
- Tipo de problema: Experiencia de Usuario, Manejo de Errores
- Descripción detallada del problema: Al igual que `login.html`, el formulario no tiene un área dedicada para mostrar mensajes de error o de éxito (ej. "Este correo ya está en uso", "Registro exitoso").
- Impacto potencial: El usuario no recibe una retroalimentación clara y contextual sobre el resultado del proceso de registro, dependiendo únicamente de `alert()s` disruptivos.
- Dependencias afectadas: `js/auth.js`.

- Archivo: register.html
- Ruta completa: /register.html
- Función / método / bloque afectado: <script> tags
- Línea(s) involucrada(s): 47-48
- Tipo de problema: Rendimiento, Mantenibilidad
- Descripción detallada del problema: Los scripts se cargan al final del `<body>` sin los atributos `defer` o `async`.
- Impacto potencial: Potencial retraso en la interactividad de la página y gestión de scripts más compleja a medida que la aplicación crezca.
- Dependencias afectadas: Ejecución del registro.
- Archivo: student-dashboard.html
- Ruta completa: /student-dashboard.html
- Función / método / bloque afectado: Global <head>
- Línea(s) involucrada(s): 6
- Tipo de problema: Dependencia Externa, Rendimiento
- Descripción detallada del problema: El archivo carga Tailwind CSS desde una CDN, replicando el problema de los otros archivos HTML.
- Impacto potencial: Dependencia de un servicio externo y carga de estilos innecesarios.
- Dependencias afectadas: Renderizado visual del dashboard del estudiante.

- Archivo: student-dashboard.html
- Ruta completa: /student-dashboard.html
- Función / método / bloque afectado: <div> id="tasks-list"
- Línea(s) involucrada(s): 17
- Tipo de problema: Experiencia de Usuario
- Descripción detallada del problema: La lista de tareas está inicialmente vacía. No hay un indicador de carga (spinner) o un mensaje de "Cargando tareas..." mientras se realiza la petición al backend.
- Impacto potencial: Si la petición al backend es lenta, el usuario verá una página vacía sin ninguna indicación de que el contenido se está cargando, lo que puede llevar a la percepción de que la página está rota o no funciona.
- Dependencias afectadas: `js/student.js`.

- Archivo: student-dashboard.html
- Ruta completa: /student-dashboard.html
- Función / método / bloque afectado: <div> id="tasks-list"
- Línea(s) involucrada(s): 17
- Tipo de problema: Experiencia de Usuario
- Descripción detallada del problema: No hay un estado definido en el HTML para cuando el estudiante no tiene tareas pendientes.
- Impacto potencial: Si no hay tareas, la lista simplemente permanecerá vacía, lo cual puede ser ambiguo para el usuario. Un mensaje claro como "No tienes tareas pendientes en este momento" mejoraría la experiencia.
- Dependencias afectadas: `js/student.js`.

- Archivo: student-dashboard.html
- Ruta completa: /student-dashboard.html
- Función / método / bloque afectado: <div id="submission-modal">
- Línea(s) involucrada(s): 22-38
- Tipo de problema: Experiencia de Usuario, Manejo de Errores
- Descripción detallada del problema: El modal de entrega de tareas no tiene un área para mostrar mensajes de error (ej. "El archivo es demasiado grande", "Formato de archivo no permitido", "Error al subir el archivo"). Tampoco muestra un indicador de carga mientras el archivo se está subiendo.
- Impacto potencial: Si la subida del archivo falla, el usuario no sabrá por qué. Durante la subida de un archivo grande, el usuario no tendrá retroalimentación visual de que la operación está en progreso, pudiendo pensar que la página se ha colgado.
- Dependencias afectadas: `js/student.js`.

- Archivo: student-dashboard.html
- Ruta completa: /student-dashboard.html
- Función / método / bloque afectado: <script> tags
- Línea(s) involucrada(s): 41-42
- Tipo de problema: Rendimiento, Mantenibilidad
- Descripción detallada del problema: Los scripts se cargan al final del `<body>` sin los atributos `defer` o `async`.
- Impacto potencial: Potencial retraso en la interactividad y complejidad en la gestión de scripts.
- Dependencias afectadas: Funcionalidad del dashboard.
- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: Global <head>
- Línea(s) involucrada(s): 6
- Tipo de problema: Dependencia Externa, Rendimiento
- Descripción detallada del problema: El archivo carga Tailwind CSS desde una CDN.
- Impacto potencial: Dependencia de un servicio externo y carga de estilos no utilizados, afectando el rendimiento.
- Dependencias afectadas: Renderizado visual del dashboard del profesor.

- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: <tbody id="submissions-table-body">
- Línea(s) involucrada(s): 45
- Tipo de problema: Experiencia de Usuario
- Descripción detallada del problema: La tabla de entregas está vacía por defecto. No hay un estado de carga (spinner) visible mientras se esperan los datos del backend.
- Impacto potencial: Si la API `getTeacherActivity` es lenta, el profesor verá una tabla vacía y podría pensar que no hay entregas o que la página está rota.
- Dependencias afectadas: `js/teacher.js`.

- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: <tbody id="submissions-table-body">
- Línea(s) involucrada(s): 45
- Tipo de problema: Experiencia de Usuario
- Descripción detallada del problema: No existe una fila o mensaje predefinido en la tabla para indicar que "No hay entregas para mostrar".
- Impacto potencial: Una tabla completamente vacía puede ser confusa. Un mensaje claro mejoraría la usabilidad.
- Dependencias afectadas: `js/teacher.js`.

- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: Formularios de "Crear Tarea" y "Crear Examen"
- Línea(s) involucrada(s): 52-127, 131-190
- Tipo de problema: Experiencia de Usuario, Manejo de Errores
- Descripción detallada del problema: Ninguno de los formularios tiene un área designada para mostrar mensajes de éxito o error al profesor después de enviar los datos.
- Impacto potencial: La única retroalimentación es a través de `alert()`, que es una mala práctica de UX. No hay una forma clara de comunicar errores de validación o problemas de conexión con el backend.
- Dependencias afectadas: `js/teacher.js`.

- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: <input id="gradoAsignado">, <input id="exam-grado">
- Línea(s) involucrada(s): 101, 150-155
- Tipo de problema: Usabilidad, Integridad de Datos
- Descripción detallada del problema: En el formulario de "Crear Tarea", el campo "Grado Asignado" es un `<input type="text">`, mientras que en el de "Crear Examen" es un `<select>`.
- Impacto potencial: El campo de texto libre para el grado en las tareas permite inconsistencias de datos (ej. "Decimo", "décimo", "10mo"), lo que complicará el filtrado de tareas para los estudiantes. El uso de un `<select>` en el formulario de exámenes es una mejor práctica que no se aplica consistentemente.
- Dependencias afectadas: Lógica de `getStudentTasks` en el backend.

- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: <input id="seccionAsignada">, <input id="exam-seccion">
- Línea(s) involucrada(s): 105, 159
- Tipo de problema: Usabilidad, Integridad de Datos
- Descripción detallada del problema: Ambos campos de "Sección" son de texto libre.
- Impacto potencial: Similar al campo de grado, esto permite la entrada de datos inconsistentes para la sección, afectando la correcta asignación y visualización de actividades a los estudiantes.
- Dependencias afectadas: Lógica de `getStudentTasks` en el backend.

- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: <div id="questions-container">
- Línea(s) involucrada(s): 173
- Tipo de problema: Lógica, Arquitectura Frontend
- Descripción detallada del problema: El contenedor de preguntas para el examen está vacío. Las preguntas se generan dinámicamente con JavaScript.
- Impacto potencial: Aunque esto es necesario para la funcionalidad, no hay una plantilla HTML (`<template>`) definida para la estructura de una pregunta. Esto significa que todo el HTML de las preguntas está hardcodeado en el archivo JavaScript (`teacher.js`), mezclando la estructura (HTML) con la lógica (JS) y haciendo más difícil modificar el diseño de una pregunta.
- Dependencias afectadas: `js/teacher.js`.

- Archivo: teacher-dashboard.html
- Ruta completa: /teacher-dashboard.html
- Función / método / bloque afectado: <script> tags
- Línea(s) involucrada(s): 229-230
- Tipo de problema: Rendimiento, Mantenibilidad
- Descripción detallada del problema: Los scripts se cargan al final del `<body>` sin `defer` o `async`.
- Impacto potencial: Potencial retraso en la interactividad y complejidad en la gestión de scripts.
- Dependencias afectadas: Funcionalidad del dashboard.
- Archivo: js/config.js
- Ruta completa: /js/config.js
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 1-24
- Tipo de problema: Configuración, Seguridad, Mantenibilidad
- Descripción detallada del problema: Las URLs de los microservicios de backend están hardcodeadas en un archivo JavaScript que se sube al repositorio de control de versiones y es servido públicamente.
- Impacto potencial:
    1.  **Exposición de Endpoints**: Cualquiera puede inspeccionar el archivo y conocer las URLs exactas de los servicios de backend, facilitando posibles ataques directos a las APIs.
    2.  **Gestión de Entornos**: No existe una manera fácil de cambiar las URLs para diferentes entornos (ej. desarrollo, pruebas, producción). Cada cambio requiere una modificación manual del archivo y un nuevo commit.
    3.  **Seguridad**: Aunque los scripts de Google Apps son relativamente seguros, exponer las URLs directamente es una mala práctica de seguridad. Si se descubriera una vulnerabilidad, los atacantes ya tendrían el punto de entrada.
- Dependencias afectadas: Todos los demás archivos JavaScript (`auth.js`, `student.js`, `teacher.js`) que dependen de `SERVICE_URLS` para hacer llamadas al backend.
- Archivo: js/auth.js
- Ruta completa: /js/auth.js
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 5
- Tipo de problema: Seguridad
- Descripción detallada del problema: Los datos de la sesión del usuario (`currentUser`), incluyendo nombre, rol, grado y sección, se almacenan en `localStorage`.
- Impacto potencial: `localStorage` es accesible por cualquier script que se ejecute en la misma página (vulnerabilidad a XSS). Un atacante podría robar los datos del usuario o incluso modificarlos. Por ejemplo, podría cambiar el `rol` de "Estudiante" a "Profesor" en el objeto almacenado, lo que podría darle acceso no autorizado a la Módulo del profesor si la validación del lado del servidor es insuficiente.
- Dependencias afectadas: Seguridad de la sesión en toda la aplicación.

- Archivo: js/auth.js
- Ruta completa: /js/auth.js
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 7-12
- Tipo de problema: Lógica de Negocio
- Descripción detallada del problema: La redirección del usuario después del login se basa únicamente en el rol almacenado en `localStorage`.
- Impacto potencial: Si un usuario malintencionado modifica el valor de `rol` en `localStorage` (de "Estudiante" a "Profesor"), podría ser redirigido al dashboard del profesor. Aunque el backend debería prevenir que realice acciones de profesor, esto le permitiría acceder y ver la interfaz de profesor, lo cual es un fallo de seguridad y de lógica.
- Dependencias afectadas: `teacher-dashboard.html`, `student-dashboard.html`.

- Archivo: js/auth.js
- Ruta completa: /js/auth.js
- Función / método / bloque afectado: fetchApi
- Línea(s) involucrada(s): 15-25
- Tipo de problema: Mantenibilidad, Duplicación de Código
- Descripción detallada del problema: La función `fetchApi` es una función de ayuda para realizar llamadas a la API. Esta misma lógica (o una muy similar) será necesaria en otros archivos JavaScript como `student.js` y `teacher.js`.
- Impacto potencial: Si no se centraliza, cada archivo tendrá su propia implementación para llamar al backend. Si se necesita un cambio en la forma en que se realizan las llamadas (por ejemplo, para agregar un encabezado de autorización o mejorar el manejo de errores), el cambio tendría que ser replicado en múltiples archivos, lo que es propenso a errores.
- Dependencias afectadas: `student.js`, `teacher.js`.

- Archivo: js/auth.js
- Ruta completa: /js/auth.js
- Función / método / bloque afectado: fetchApi
- Línea(s) involucrada(s): 22
- Tipo de problema: Manejo de Errores, Red
- Descripción detallada del problema: El comentario `// No es necesario 'Content-Type' aquí, Apps Script lo maneja.` es incorrecto. Google Apps Script es sensible a la falta del `Content-Type` correcto para `POST` requests, especialmente cuando se manejan CORS. La práctica recomendada es a menudo usar `text/plain` para evitar `preflight requests` de CORS. La ausencia de este encabezado puede causar fallos de red inesperados o difíciles de depurar en ciertos navegadores o condiciones de red.
- Impacto potencial: Las peticiones pueden fallar de forma intermitente o ser bloqueadas por políticas de CORS en algunos entornos, haciendo la aplicación poco fiable.
- Dependencias afectadas: Todas las llamadas al backend.

- Archivo: js/auth.js
- Ruta completa: /js/auth.js
- Función / método / bloque afectado: Event listeners de login y registro
- Línea(s) involucrada(s): 48, 52, 79, 83
- Tipo de problema: Experiencia de Usuario
- Descripción detallada del problema: Se utiliza `alert()` para comunicar errores y mensajes de éxito al usuario.
- Impacto potencial: Es una mala práctica de UX que interrumpe el flujo del usuario, bloquea la interfaz y es visualmente inconsistente. Impide mostrar errores o mensajes de forma integrada en el diseño de los formularios.
- Dependencias afectadas: `login.html`, `register.html`.

- Archivo: js/auth.js
- Ruta completa: /js/auth.js
- Función / método / bloque afectado: Event listener de registro
- Línea(s) involucrada(s): 63-69
- Tipo de problema: Validation
- Descripción detallada del problema: No existe validación de datos en el lado del cliente antes de enviar la petición de registro. Por ejemplo, no se comprueba si la contraseña tiene una longitud mínima o si los campos obligatorios están realmente llenos (aunque el HTML tenga `required`, una validación en JS es más robusta).
- Impacto potencial: Se envían peticiones al backend que se sabe que fallarán, consumiendo recursos innecesariamente. La experiencia del usuario es pobre porque la retroalimentación sobre datos inválidos no es instantánea.
- Dependencias afectadas: `register.html`, backend.
- Archivo: js/student.js
- Ruta completa: /js/student.js
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 3
- Tipo de problema: Seguridad, Lógica de Negocio
- Descripción detallada del problema: El script comprueba si el `rol` del usuario en `localStorage` es "Estudiante" o "Alumno". Si no lo es, redirige a `login.html`.
- Impacto potencial: Esta es una comprobación del lado del cliente únicamente. Un usuario autenticado como profesor podría evadir esta redirección (por ejemplo, desactivando JavaScript) e intentar interactuar con la página. Más importante aún, el uso de dos valores diferentes ("Estudiante", "Alumno") para el mismo rol es una inconsistencia de datos que puede causar problemas. El backend solo usa "Estudiante".
- Dependencias afectadas: Consistencia de datos de roles, seguridad de acceso a la página.

- Archivo: js/student.js
- Ruta completa: /js/student.js
- Función / método / bloque afectado: fetchApi
- Línea(s) involucrada(s): 13-19
- Tipo de problema: Duplicación de Código
- Descripción detallada del problema: La función `fetchApi` está duplicada. Es casi idéntica a la que se encuentra en `js/auth.js`.
- Impacto potencial: Dificulta el mantenimiento. Cualquier cambio en la lógica de comunicación con el backend debe replicarse en todos los archivos que contengan esta función.
- Dependencias afectadas: Mantenibilidad del código de frontend.

- Archivo: js/student.js
- Ruta completa: /js/student.js
- Función / método / bloque afectado: fetchAllActivities
- Línea(s) involucrada(s): 28-29
- Tipo de problema: Lógica de Negocio, Funcionalidad Inexistente
- Descripción detallada del problema: El código intenta obtener exámenes para el estudiante llamando a una acción `getExamQuestions` en el servicio de exámenes. Sin embargo, según el `README.md` y el código de `backend.gs`, `getExamQuestions` está diseñada para obtener las preguntas de un *único* examen (`examenId`) y no para listar todos los exámenes de un estudiante. El comentario `// Asumiendo un endpoint así` confirma que esta funcionalidad no existe en el backend.
- Impacto potencial: La llamada a la API de exámenes fallará, y la aplicación no podrá mostrar los exámenes asignados al estudiante. El dashboard del estudiante está funcionalmente incompleto.
- Dependencias afectadas: Backend (`exam-service`), visualización de actividades del estudiante.

- Archivo: js/student.js
- Ruta completa: /js/student.js
- Función / método / bloque afectado: fetchAllActivities
- Línea(s) involucrada(s): 35
- Tipo de problema: Lógica de Negocio, Manejo de Datos
- Descripción detallada del problema: El código intenta combinar los resultados de tareas y exámenes con `[...tasksResult.data, ...examsResult.data]`.
- Impacto potencial: Incluso si la llamada a la API de exámenes funcionara, los objetos de "tarea" y "examen" tienen estructuras diferentes (según el `README.md`). Combinarlos y renderizarlos con una única función (`renderActivities`) sin una transformación o mapeo previo causará errores de renderizado. El comentario `// Simplificado, necesita adaptación` indica que esto no está implementado.
- Dependencias afectadas: `renderActivities`.

- Archivo: js/student.js
- Ruta completa: /js/student.js
- Función / método / bloque afectado: renderActivities
- Línea(s) involucrada(s): 45-53
- Tipo de problema: Funcionalidad Incompleta
- Descripción detallada del problema: El comentario `// Por simplicidad, se mantiene la lógica de renderizado de tareas por ahora.` y la ausencia de código para manejar los exámenes confirman que la función solo sabe cómo renderizar tareas.
- Impacto potencial: Los exámenes no se mostrarán en el dashboard del estudiante, incluso si la API los devolviera.
- Dependencias afectadas: Visualización de actividades del estudiante.

- Archivo: js/student.js
- Ruta completa: /js/student.js
- Función / método / bloque afectado: submissionForm.addEventListener
- Línea(s) involucrada(s): 57
- Tipo de problema: N/A (Observación)
- Descripción detallada del problema: El código para manejar el envío de tareas (`submitAssignment`) existe, pero no hay una lógica equivalente para manejar la entrega de exámenes, que requeriría redirigir a una página de examen diferente (`exam.html`).
- Impacto potencial: La funcionalidad para que un estudiante inicie un examen desde el dashboard no está presente.
- Dependencias afectadas: Flujo de realización de exámenes.
- Archivo: js/teacher.js
- Ruta completa: /js/teacher.js
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 112
- Tipo de problema: Seguridad
- Descripción detallada del problema: La validación de la sesión del profesor se realiza únicamente en el lado del cliente, comprobando un valor en `localStorage`.
- Impacto potencial: Un usuario no autorizado podría manipular el `localStorage` para acceder a la interfaz del dashboard del profesor. Aunque las llamadas a la API deberían fallar si el backend está bien implementado, esto expone la interfaz administrativa.
- Dependencias afectadas: Seguridad de la sección de profesor.

- Archivo: js/teacher.js
- Ruta completa: /js/teacher.js
- Función / método / bloque afectado: fetchApi
- Línea(s) involucrada(s): 10-19
- Tipo de problema: Duplicación de Código
- Descripción detallada del problema: La función `fetchApi` está duplicada y es casi idéntica a las encontradas en `js/auth.js` y `js/student.js`.
- Impacto potencial: Alto costo de mantenimiento. Un cambio en la lógica de API requiere modificaciones en múltiples archivos.
- Dependencias afectadas: Mantenibilidad del código de frontend.

- Archivo: js/teacher.js
- Ruta completa: /js/teacher.js
- Función / método / bloque afectado: fetchTeacherActivity
- Línea(s) involucrada(s): 26
- Tipo de problema: Lógica de Negocio
- Descripción detallada del problema: El código asume que el backend tiene dos endpoints separados, `getTeacherActivity` para tareas y `getTeacherExamActivity` para exámenes.
- Impacto potencial: Aunque esto funciona, es ineficiente. Requiere dos llamadas de red paralelas para poblar una única vista. El `backend.gs` actual tiene una sola función `getTeacherActivity` que ya combina ambas fuentes de datos, por lo que este enfoque del frontend es inconsistente con la implementación optimizada del backend y realiza una llamada (`getTeacherExamActivity`) a una acción que no existe en el `switch` principal del backend.
- Dependencias afectadas: Backend.

- Archivo: js/teacher.js
- Ruta completa: /js/teacher.js
- Función / método / bloque afectado: renderActivity
- Línea(s) involucrada(s): 80
- Tipo de problema: Seguridad, Vulnerabilidad XSS
- Descripción detallada del problema: La función `renderActivity` construye el HTML de la tabla inyectando directamente los datos de la API en la cadena HTML, y luego asigna esto al `innerHTML` de la tabla. El `item` completo se pasa a `openGradeModal` usando `JSON.stringify`.
- Impacto potencial: Si alguno de los campos devueltos por la API (como `alumnoNombre`, `titulo`, etc.) contuviera código HTML o script malicioso (ej. `<script>alert(1)</script>`), se ejecutaría en el navegador del profesor. Esto es una vulnerabilidad de Cross-Site Scripting (XSS).
- Dependencias afectadas: Seguridad del dashboard del profesor.

- Archivo: js/teacher.js
- Ruta completa: /js/teacher.js
- Función / método / bloque afectado: createAssignmentForm.addEventListener, reactivateExam, saveGradeBtn.addEventListener, createExamForm.addEventListener
- Línea(s) involucrada(s): 140, 154, 168, 178, 189
- Tipo de problema: Experiencia de Usuario
- Descripción detallada del problema: Todas las interacciones con el backend (crear tarea, reactivar examen, guardar calificación, crear examen) usan `alert()` para mostrar mensajes de éxito y error.
- Impacto potencial: Mala experiencia de usuario, interrumpiendo el flujo de trabajo del profesor con pop-ups modales del navegador.
- Dependencias afectadas: `teacher-dashboard.html`.

- Archivo: js/teacher.js
- Ruta completa: /js/teacher.js
- Función / método / bloque afectado: Global (scope de `window`)
- Línea(s) involucrada(s): 161, 171
- Tipo de problema: Arquitectura, Contaminación del Scope Global
- Descripción detallada del problema: Las funciones `reactivateExam` y `openGradeModal` se adjuntan directamente al objeto `window`.
- Impacto potencial: Esto contamina el namespace global, lo que puede llevar a colisiones de nombres si se añaden otras librerías o scripts que usen los mismos nombres de función. Es una práctica considerada poco segura y difícil de mantener. La forma moderna es usar `addEventListener` para adjuntar eventos a los elementos.
- Dependencias afectadas: Mantenibilidad y robustez del script.

- Archivo: js/teacher.js
- Ruta completa: /js/teacher.js
- Función / método / bloque afectado: Lógica de "Crear Examen"
- Línea(s) involucrada(s): 194-221 (no visible en el extracto, pero inferido de la estructura)
- Tipo de problema: Mantenibilidad, Mezcla de incumbencias
- Descripción detallada del problema: El código para generar el HTML de las preguntas del examen (campos de texto, opciones, etc.) está hardcodeado dentro del archivo JavaScript.
- Impacto potencial: Al igual que el problema identificado en `teacher-dashboard.html`, esto mezcla la lógica de la aplicación con la estructura de la presentación. Si un diseñador necesita cambiar el layout de una pregunta, tiene que editar un archivo JavaScript, lo cual es ineficiente y propenso a errores. Usar una etiqueta `<template>` en el HTML sería una solución mucho más limpia.
- Dependencias afectadas: Mantenibilidad del formulario de creación de exámenes.

--- AUDITORÍA POST-IMPLEMENTACIÓN (MÓDULO DE EXÁMENES) ---

- Archivo: backend/exam-service/Code.gs
- Función / método / bloque afectado: doPost
- Tipo de problema: Lógica de Negocio (Crítico)
- Descripción detallada del problema: La función `doPost` en el microservicio de exámenes carecía de un `case` para la acción `getStudentExams`.
- Impacto potencial: Esto rompía una funcionalidad principal de la aplicación, ya que cualquier llamada desde el frontend del estudiante para obtener la lista de sus exámenes asignados fallaba con un error de "Acción no reconocida". Los estudiantes no podían ver ni realizar ningún examen.
- Solución: Se añadió la línea `case "getStudentExams": result = getStudentExams(payload); break;` al `switch` en la función `doPost`.

- Archivo: backend/exam-service/Code.gs
- Función / método / bloque afectado: doPost
- Tipo de problema: Configuración de Red (Crítico)
- Descripción detallada del problema: Las respuestas enviadas desde la función `doPost` (tanto en casos de éxito como de error) no incluían las cabeceras CORS necesarias (`Access-Control-Allow-Origin`).
- Impacto potencial: Esto causaba errores intermitentes de `TypeError: Failed to fetch` en el frontend, ya que los navegadores bloqueaban las respuestas que no cumplían con la política de CORS. Hacía que la aplicación fuera inestable y poco fiable.
- Solución: Se añadió `.setHeaders(corsHeaders)` a todas las declaraciones `ContentService.createTextOutput(...)` dentro del `try/catch` de `doPost`.

- Archivo: backend/exam-service/Code.gs
- Función / método / bloque afectado: getStudentExams
- Tipo de problema: Lógica de Negocio
- Descripción detallada del problema: La función devolvía todos los exámenes asignados a un grado y sección, sin filtrar por el estado "Activo" del examen.
- Impacto potencial: Los estudiantes habrían visto en su dashboard exámenes que los profesores habían creado pero aún no habían activado, lo que podría causar confusión y permitir el acceso a exámenes antes de tiempo.
- Solución: Se agregó un filtro adicional en la función para incluir solo los exámenes donde `estadoExamen === 'Activo'`.

- Archivo: js/teacher.js
- Función / método / bloque afectado: renderActivity
- Tipo de problema: Bug Visual (Menor)
- Descripción detallada del problema: La función de renderizado de la tabla de actividades del profesor solo comprobaba la propiedad `item.fecha` para mostrar la fecha. Los exámenes base (sin entregas) usan `item.fechaLimite`.
- Impacto potencial: Los exámenes recién creados que aún no tenían entregas mostraban "N/A" en la columna de fecha en lugar de la fecha límite correcta.
- Solución: Se modificó la plantilla de renderizado para usar `(item.fecha || item.fechaLimite)` al formatear la fecha, asegurando que siempre se muestre la fecha correcta.

- Archivo: backend/exam-service/Code.gs
- Función / método / bloque afectado: updateExamStatus, getAllExams
- Tipo de problema: Mantenibilidad (Deuda Técnica)
- Descripción detallada del problema: Las funciones que interactúan con la hoja de cálculo "Examenes" utilizan índices de columna hardcodeados (ej. `getRange(i + 1, 8)` para actualizar el estado).
- Impacto potencial: Si la estructura de la hoja de cálculo cambia en el futuro (se añade, elimina o reordena una columna), estas funciones fallarán o, peor aún, corromperán los datos al escribir en la columna equivocada.
- Solución (Recomendación): Refactorizar estas funciones para que lean la fila de encabezados y accedan a las columnas por su nombre en lugar de por su índice numérico, lo que las haría más resistentes a los cambios estructurales.

--- AUDITORÍA PREVENTIVA (ALINEACIÓN DE FLUJO) ---

- Archivo: backend/user-service/Code.gs
- Ruta completa: /backend/user-service/Code.gs
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 1-147
- Tipo de problema: Verificación de Arquitectura
- Descripción detallada del problema: Se realizó una auditoría línea por línea del microservicio de usuarios para identificar potenciales errores de referencia a funciones no definidas, problemas de alcance (scope) o de orden de carga, en alineación con un problema previamente detectado en otro servicio.
- Hallazgo: El archivo `Code.gs` del servicio de usuarios constituye un único script autocontenido. Todas las funciones (`logDebug`, `getSheetOrThrow`, `doGet`, `doPost`, `registerUser`, `loginUser`, etc.) son definidas en el scope global de Google Apps Script. Debido al mecanismo de 'hoisting' de Apps Script, que hace que todas las declaraciones de funciones estén disponibles globalmente antes de la ejecución, no existe riesgo de que una función sea llamada antes de ser definida.
- Impacto potencial: Nulo. La arquitectura actual del archivo es monolítica y previene este tipo de error de referencia.
- Dependencias afectadas: Ninguna.

- Archivo: backend/task-service/Code.gs
- Ruta completa: /backend/task-service/Code.gs
- Función / método / bloque afectado: Global
- Línea(s) involucrada(s): 1-220
- Tipo de problema: Verificación de Arquitectura
- Descripción detallada del problema: Se realizó una auditoría línea por línea del microservicio de tareas bajo el mismo criterio de la auditoría del servicio de usuarios, buscando prevenir errores de referencia a funciones no definidas.
- Hallazgo: Al igual que el servicio de usuarios, el servicio de tareas está implementado como un único script `Code.gs`. Todas sus funciones son declaradas en el scope global y están disponibles durante todo el ciclo de vida de la ejecución del script gracias al 'hoisting' de Apps Script. No se encontraron dependencias implícitas frágiles ni llamadas a funciones que pudieran no estar definidas en el momento de su invocación.
- Impacto potencial: Nulo. La arquitectura actual del archivo previene este tipo de error de referencia.
- Dependencias afectadas: Ninguna.

--- AUDITORÍA DE IMPLEMENTACIÓN DE ARREGLOS (MICROSERVICIOS) ---

- Archivos: backend/user-service/Code.gs, backend/task-service/Code.gs
- Descripción: Esta tarea aborda hallazgos clave de auditorías previas para mejorar la seguridad, robustez y mantenibilidad de los servicios.
- Alcance de los Cambios:
  1.  **Manejo de Errores (Ambos Servicios):** Se modificará el bloque `catch` en las funciones `doPost` para registrar el error completo en el servidor usando `logDebug` y devolver un mensaje genérico ("Error interno del servidor.") al cliente, previniendo la exposición de detalles de implementación.
  2.  **Generación de ID de Usuario (`user-service`):** Se reemplazará la generación de `userId` basada en `new Date().getTime()` por `Utilities.getUuid()` en la función `registerUser` para garantizar la unicidad de los identificadores.
  3.  **Extracción de Tipo MIME (`task-service`):** Se hará más robusta la lógica de extracción del tipo MIME en `submitAssignment` para manejar correctamente casos donde la expresión regular podría fallar.
  4.  **Índices de Columna (`task-service`):** Se refactorizará la función `gradeSubmission` para que obtenga los índices de las columnas de la hoja de cálculo por su nombre de encabezado en lugar de usar índices numéricos codificados, aumentando la resiliencia ante cambios en la estructura de la hoja.

AUDITORÍA PRE-EDICIÓN (13/01/2026)
------------------------------------
- Archivo: js/teacher.js
- Línea(s): 91-95
- Hallazgo: La lógica de renderizado de enlaces de archivos utiliza directamente el valor de 'item.fileId'. El problema es que este campo contiene la URL completa de Google Drive en lugar del ID del archivo, lo que provoca la generación de URLs de descarga y visualización incorrectas. Se requiere añadir un paso para extraer el ID desde la URL.


AUDITORÍA POST-CODE-REVIEW (13/01/2026)
---------------------------------------
- Archivo: js/teacher.js
- Línea(s): 226
- Hallazgo (originado en Code Review): La función 'openGradeModal' genera el enlace de descarga del archivo para el modal de calificación. Se ha detectado que esta función utiliza directamente 'entrega.fileId', que es una URL completa, en lugar de extraer primero el ID del archivo. Esto reproduce el mismo error que se corrigió en la tabla principal.


AUDITORÍA POST-IMPLEMENTACIÓN (13/01/2026)
------------------------------------------
- Archivo: js/teacher.js
- Línea(s): 98, 183
- Hallazgo: Se ha identificado un nuevo formato de URL de archivo no estándar () que la lógica de extracción de ID actual no es capaz de procesar. La expresión regular existente solo maneja el formato estándar de Google Drive. Es necesario implementar una solución más robusta que pueda manejar múltiples patrones de URL.


AUDITORÍA POST-IMPLEMENTACIÓN (13/01/2026)
------------------------------------------
- Archivo: js/teacher.js
- Línea(s): 98, 183
- Hallazgo: Se ha identificado un nuevo formato de URL de archivo no estándar ('.../IMA-Informatica/ID_DEL_ARCHIVO') que la lógica de extracción de ID actual no es capaz de procesar. La expresión regular existente solo maneja el formato estándar de Google Drive. Es necesario implementar una solución más robusta que pueda manejar múltiples patrones de URL.

AUDITORÍA FINAL (POST-CODE-REVIEW) (13/01/2026)
-----------------------------------------------
- Archivo: js/teacher.js
- Línea(s): 45-68
- Hallazgo (crítico, originado en Code Review): Se ha detectado una regresión funcional en la lógica de 'extractDriveId'. La función está diseñada para extraer un ID a partir de una URL, pero no contempla el escenario en que el dato de entrada ya es un ID de archivo limpio. Dado que el backend fue mejorado para proveer IDs limpios, esta función fallará para todas las nuevas entregas, retornando 'null' y rompiendo la generación de enlaces.

AUDITORÍA DE CALIFICACIÓN (13/01/2026)
-------------------------------------
- Archivos: backend/task-service/Code.gs, js/teacher.js
- Hallazgo: El payload de calificación enviado desde el frontend es correcto. El código del backend en el repositorio para 'gradeSubmission' también es correcto. La causa probable del 'error interno del servidor' es que la versión desplegada del script de Google Apps no contiene la corrección del error 'off-by-one' que se implementó anteriormente.

AUDITORÍA DE ENDPOINTS (13/01/2026)
----------------------------------
- Tarea: Actualización de la URL del servicio TASK.
- Hallazgo: Inicio del proceso de verificación de endpoints. Se confirmó la conectividad externa y la operatividad de los servicios USER y EXAM como línea de base antes de probar la nueva URL de TASK.


AUDITORÍA DE SERVICIOS (13/01/2026)
----------------------------------
- Archivos: backend/exam-service/Code.gs, js/teacher.js, backend/task-service/Code.gs, README.md

- Hallazgo 1 (Servicio EXAM): El frontend ('js/teacher.js') llama a la acción 'getTeacherExamActivity'. Sin embargo, esta acción no está definida en el backend ('backend/exam-service/Code.gs'), lo que causa el error "Acción no válida". La documentación en README.md menciona la acción, pero la implementación no la incluye.

- Hallazgo 2 (Servicio TASK): El error "interno del servidor" al calificar persiste porque la función 'gradeSubmission' en 'backend/task-service/Code.gs' busca los nombres de columna "Calificación", "Estado" y "Comentario" (con mayúsculas y tildes). Sin embargo, la documentación oficial en README.md especifica que los nombres de columna son en minúsculas: "calificacion", "estado" y "comentario". Esta discrepancia hace que 'indexOf' falle y la función lance un error.

**AUDITORÍA PRE-EDICIÓN**
- **FECHA:** 2026-01-14
- **ARCHIVOS REVISADOS:**
  - js/teacher.js
  - teacher-dashboard.html
- **HALLAZGOS:**
  1. **Archivo:** js/teacher.js
     - **Línea:** 129 (condicional )
     - **Observación:** La renderización de los botones de control de examen ('Activar'/'Bloquear') depende de que el objeto de actividad tenga una propiedad  igual a . Esta condición es el punto central del problema.
  2. **Archivo:** js/teacher.js
     - **Línea:** 90 (función )
     - **Observación:** Se detecta un intento explícito de añadir la propiedad  a los exámenes base (aquellos sin entregas) después de ser recuperados de la API.
     - **Hipótesis:** La causa probable del problema es que los objetos de examen que llegan a la función  carecen de la propiedad . Esto puede deberse a que la llamada a  no devuelve los datos esperados, o a un problema en la lógica de transformación de datos previa a la renderización.
  3. **Archivo:** teacher-dashboard.html
     - **Observación:** La estructura HTML es correcta y está preparada para recibir el contenido dinámico. No se identifican anomalías en este archivo.
- **CONCLUSIÓN:** El problema se origina en el flujo de datos de . Se debe verificar la respuesta de la API  y el estado de los objetos de examen antes de la llamada a  para asegurar que la propiedad  esté presente.


**AUDITORÍA PRE-EDICIÓN**
- **FECHA:** 2026-01-14
- **ARCHIVOS REVISADOS:**
  - js/teacher.js
  - teacher-dashboard.html
- **HALLAZGGOS:**
  1. **Archivo:** js/teacher.js
     - **Línea:** 129 (condicional `else if (item.tipo === 'Examen')`)
     - **Observación:** La renderización de los botones de control de examen ('Activar'/'Bloquear') depende de que el objeto de actividad tenga una propiedad `tipo` igual a `'Examen'`. Esta condición es el punto central del problema.
  2. **Archivo:** js/teacher.js
     - **Línea:** 90 (función `.map(...)`)
     - **Observación:** Se detecta un intento explícito de añadir la propiedad `tipo: 'Examen'` a los exámenes base (aquellos sin entregas) después de ser recuperados de la API.
     - **Hipótesis:** La causa probable del problema es que los objetos de examen que llegan a la función `renderActivity` carecen de la propiedad `tipo`. Esto puede deberse a que la llamada a `getAllExams` no devuelve los datos esperados, o a un problema en la lógica de transformación de datos previa a la renderización.
  3. **Archivo:** teacher-dashboard.html
     - **Observación:** La estructura HTML es correcta y está preparada para recibir el contenido dinámico. No se identifican anomalías en este archivo.
- **CONCLUSIÓN:** El problema se origina en el flujo de datos de `js/teacher.js`. Se debe verificar la respuesta de la API `getAllExams` and el estado de los objetos de examen antes de la llamada a `renderActivity` para asegurar que la propiedad `tipo` esté presente.

AUDITORÍA DE CARGA DE EXAMEN (14/01/2026)
-----------------------------------------
- Archivo: js/exam.js
- Línea(s): 41-43
- Hallazgo (Crítico): En la función `loadExam`, el código desestructura la propiedad `preguntas` de la respuesta de la API y luego intenta usar `.map()` en la variable resultante (`originalQuestions`) sin verificar si es `undefined`. Si la API devuelve un examen sin la propiedad `preguntas`, esto causa un `TypeError: Cannot read properties of undefined (reading 'map')`, bloqueando completamente la carga del examen para el estudiante.

- Archivo: js/exam.js
- Línea(s): 15-22
- Hallazgo (Mantenibilidad): El archivo contiene una función `fetchApi` duplicada, que ya existe en otros scripts como `js/api.js`. Esto viola el principio DRY y aumenta la carga de mantenimiento, ya que cualquier cambio en la lógica de la API debe replicarse en múltiples lugares.

- Archivo: js/exam.js
- Línea(s): 43
- Hallazgo (UX): Si un examen se carga correctamente pero no contiene preguntas (`preguntas` es un array vacío), la interfaz de usuario no muestra ningún mensaje. El contenedor `questions-container` simplemente permanece vacío, lo que puede confundir al estudiante, haciéndole pensar que la página está rota o no ha cargado completamente.

AUDITORÍA DE RECUPERACIÓN DE PREGUNTAS (14/01/2026)
-------------------------------------------------
- Archivo: backend/exam-service/Code.gs
- Línea(s): 190-202
- Hallazgo (Crítico): La función `getExamQuestions` devuelve una estructura de datos incorrecta que no coincide con la esperada por el frontend. El backend envía directamente un array de preguntas en la propiedad `data`, mientras que el frontend (`js/exam.js`) espera un objeto que contenga los detalles del examen (título, etc.) junto con el array de preguntas. Esta discrepancia es la causa raíz de que los exámenes se muestren como si no tuvieran preguntas.

AUDITORÍA DE DASHBOARDS Y EXÁMENES - 18/01/2026

1. student-dashboard.html:
   - No tiene encabezado estandarizado.
   - El botón de logout es un botón rojo simple en la esquina.
   - Carece de footer.
   - No utiliza el archivo css/style.css.

2. teacher-dashboard.html:
   - Desbordamiento crítico: La tabla de entregas (#submissions-table-body) no es responsiva.
   - Menú de navegación interno (Dashboard, Crear Tarea, Crear Examen) es inconsistente con el estilo de index.html.
   - Carece de footer.
   - No utiliza css/style.css.

3. exam.html y exam-results.html:
   - Diseño minimalista sin identidad visual corporativa (logo, bandera, footer).
   - El temporizador y el título del examen necesitan mejor integración visual.

4. results.html:
   - Tiene un enlace a "student.html" que podría estar roto (el archivo es student-dashboard.html).
   - Intenta cargar css/styles.css (con 's'), que no existe (es style.css).

AUDITORÍA DE AJUSTES FINALES - 18/01/2026

1. DASHBOARDS:
   - Se verificó que el espaciado entre columnas (gap) es el mínimo necesario para distinguir elementos sin desperdiciar espacio.
   - Las tarjetas de dashboard ahora son más compactas.

2. FOOTER:
   - Se confirmó mediante inspección visual y flexbox que el footer se ancla al fondo del viewport incluso en páginas con poco contenido.
   - La franja blanca ha sido eliminada.

AUDITORÍA DE TABLA DE ENTREGAS - 18/01/2026

1. teacher-dashboard.html:
   - Los encabezados de la tabla (th) usan padding p-4 (Línea 75-81).

2. js/teacher.js:
   - Las celdas de la tabla (td) se renderizan con padding p-4 (Línea 156-162).
   - El mensaje de carga también usa p-4 (Línea 72).
   - El mensaje de error usa p-4 (Línea 105).
   - El mensaje de "no hay actividad" usa p-4 (Línea 111).

AUDITORÍA FINAL DE TABLA DE ENTREGAS - 18/01/2026

1. teacher-dashboard.html:
   - Los encabezados ahora usan p-2.

2. js/teacher.js:
   - Las celdas renderizadas ahora usan p-2.
   - El espaciado visual de la tabla es ahora mucho más compacto.

AUDITORÍA DE CONFIGURACIÓN - 18/01/2026
---------------------------------------
- Archivo: js/config.js
- Línea(s): 17
- Hallazgo: La URL del microservicio TASK está desactualizada. Se requiere actualizar a la nueva implementación proporcionada por el usuario para asegurar la conectividad con la versión más reciente del backend.

AUDITORÍA DE REVISIÓN - 18/01/2026
-----------------------------------
- Archivo: backend/task-service/Code.gs
- Línea(s): 124 (Función uploadFile)
- Hallazgo: Se verificó la definición de `tituloTarea`. Aunque el código review indicó que no estaba definida, se confirma que se recupera de `tareasSheet` correctamente. Se mantendrá bajo observación.
- Archivo: js/student.js
- Línea(s): 198-202
- Hallazgo: La implementación de carga en segundo plano utilizaba un flag booleano que podía causar condiciones de carrera. Se rediseñó usando un contador de subidas activas (`activeUploads`) para garantizar que el botón de confirmación solo se habilite cuando TODOS los archivos hayan terminado de subirse.

AUDITORÍA DE CONFIGURACIÓN - 18/01/2026
---------------------------------------
- Archivo: js/config.js
- Línea(s): 17
- Hallazgo: La URL del microservicio TASK ha sido actualizada nuevamente por el usuario. Se requiere realizar el cambio a la última implementación proporcionada para mantener la sincronización con el backend.

AUDITORÍA DE INTERFAZ Y SERVICIOS - 20/01/2026
-------------------------------------------------------------------
- Archivo: login.html / register.html
  - Hallazgo: Los botones de envío (type="submit") carecen de estado de carga. El usuario puede hacer clic múltiples veces durante la espera de la API.

- Archivo: student-dashboard.html
  - Hallazgo: El botón "Confirmar Entrega" (#confirm-submission-btn) no se deshabilita ni muestra animación de carga al enviar la tarea final al backend.

- Archivo: teacher-dashboard.html
  - Hallazgo: Múltiples botones de acción (Crear Tarea, Crear Examen, Guardar Calificación, Activar, Bloquear, Reactivar) no proporcionan feedback visual de "Cargando..." ni se deshabilitan tras el clic, permitiendo envíos duplicados.

- Archivo: exam.html / js/exam.js
  - Hallazgo: El botón de entrega de examen no tiene estado de carga.
  - Hallazgo (Crítico): Error en el envío del examen. El frontend envía 'respuestaEstudiante' mientras que el backend espera 'respuesta'.
  - Hallazgo (Crítico): El backend devuelve la calificación directamente en la raíz del objeto de respuesta, pero el frontend espera 'result.data.entregaExamenId' para la redirección, lo que provoca un error de "Cannot read properties of undefined (reading 'entregaExamenId')".

- Archivo: tasks.html
  - Hallazgo: El archivo no existe físicamente en el repositorio. Se asume que la funcionalidad de tareas está integrada en los dashboards de estudiante y profesor.

AUDITORÍA DE FORMATO DE FECHAS (DETALLADA) - 20/01/2026
-------------------------------------------------------------------
- Archivo: backend/task-service/Code.gs
  - Hallazgo: La función `getTeacherActivity` usa `item.fecha.toLocaleString()`. Debe cambiarse a `.toISOString()`.
  - Hallazgo: La función `getStudentTasks` envía `task[8]` (objeto Date). Se recomienda enviarlo como ISO string para evitar inconsistencias en la serialización.

- Archivo: backend/exam-service/Code.gs
  - Hallazgo: La función `getTeacherExamActivity` usa `item.fecha.toLocaleString()`. Debe cambiarse a `.toISOString()`.
  - Hallazgo: La función `getAllExams` envía `r[5]` (objeto Date). Debe cambiarse a `.toISOString()`.
  - Hallazgo: La función `getStudentExams` envía `e[5]` (objeto Date). Debe cambiarse a `.toISOString()`.

- Archivo: js/teacher.js
  - Hallazgo: La función `renderActivity` intenta instanciar `new Date(item.fecha)` a partir de la cadena ya formateada que recibe del backend.
  - Hallazgo: Al fallar el parseo de la cadena regional (ej. "20/1/2026 23:45:00"), se genera un objeto "Invalid Date".
  - Hallazgo: La función `fetchTeacherActivity` también realiza un `sort` intentando instanciar `new Date()` sobre las fechas de ambas fuentes, lo que provoca un ordenamiento incorrecto si el parseo falla.

AUDITORÍA DE CIERRE - 19/01/2026
-------------------------------------------------------------------
- Archivo: js/student.js
  - Hallazgo: Se detectó una variable fantasma `isUploading` que no se actualizaba correctamente. Se reemplazó por la validación de `activeUploads > 0` para mayor confiabilidad.
  - Hallazgo: El botón `acceptFileBtn` (Aceptar subida individual) no tenía estado de carga ni bloqueo, lo que permitía clics accidentales durante el proceso inicial de subida.

- Archivo: backend/task-service/Code.gs y backend/exam-service/Code.gs
  - Verificación: Se confirmó que el cambio a `.toISOString()` resuelve definitivamente el error de "Invalid Date" al proporcionar un formato estándar parseable por todos los motores de JavaScript modernos.

- Archivo: js/config.js
  - Verificación: Se aplicaron las nuevas URLs de producción para TASK y EXAM, asegurando la conectividad con las versiones corregidas del backend.

AUDITORÍA DE LÓGICA DE EXÁMENES - 20/01/2026
-------------------------------------------------------------------
- Archivo: js/teacher.js
  - Hallazgo: En la creación de exámenes, las opciones se envían como un string plano (ej. "Verdadero,Falso"). El backend lo stringifica como JSON de un string.
  - Hallazgo: El tipo 'termino_pareado' se envía como un bloque de texto sin estructura interna, lo que impide su correcto procesamiento en el examen y en los resultados.

- Archivo: js/exam.js
  - Hallazgo: La función 'renderQuestion' espera que 'options' sea un objeto para usar 'Object.entries()'. Al recibir un string JSON-ificado, itera sobre los caracteres, causando el error visual de las letras individuales.

- Archivo: backend/exam-service/Code.gs
  - Hallazgo: La función 'getExamResult' no devuelve el título del examen ni la comparación detallada de respuestas correctas vs. estudiante, lo que causa que la página de resultados falle al intentar renderizar 'resultadosDetallados'.

- Archivo: js/results.js
  - Hallazgo: Contiene una función 'fetchApi' duplicada.
  - Hallazgo: La lógica de renderizado depende de propiedades inexistentes en la respuesta actual del backend.

AUDITORÍA INICIAL - 20/01/2026 - TAREA: Filtros, Búsqueda y Resultados de Examen
-------------------------------------------------------------------
- Archivo: backend/task-service/Code.gs: getTeacherActivity falta grado/seccion/asignatura.
- Archivo: backend/exam-service/Code.gs: getTeacherExamActivity falta grado/seccion/asignatura. Falta gradeExamSubmission.
- Archivo: js/exam.js: Redirección a results.html debe ser a student-dashboard.html.
- Archivo: js/results.js: Falta control de rol Estudiante vs Profesor.
- Archivo: teacher-dashboard.html: Falta barra de búsqueda y encabezados ordenables.
- Archivo: js/teacher.js: Falta lógica de filtrado/ordenamiento y calificación de exámenes.

AUDITORÍA INICIAL - 20/01/2026 - TAREA: Nuevas URLs y Gestión de Resultados
-------------------------------------------------------------------
- js/config.js: URLs desactualizadas.
- backend/exam-service/Code.gs: submitExam usa 'Finalizado', debe ser 'Pendiente'.
- backend/exam-service/Code.gs: getStudentExams no retorna calificacion/comentario.
- js/student.js: renderActivities no muestra feedback para exámenes.
- teacher-dashboard.html & js/teacher.js: Verificar consistencia de filtros con metadatos (grado/seccion/asignatura).

--- AUDITORÍA - 18/01/2026 - Tarea: Restricción de Actividades por Profesor y Filtros Avanzados ---

[backend/task-service/Code.gs]
- Hallazgo: La función 'createTask' no registra el ID del profesor que crea la tarea. Se requiere agregar 'profesorId' como columna K (índice 10).
- Hallazgo: 'getTeacherActivity' devuelve todas las entregas sin filtrar por profesor. Debe filtrar basándose en el 'profesorId' de la tarea asociada.

[backend/exam-service/Code.gs]
- Hallazgo: 'createExam' no registra el ID del profesor. Se requiere agregar 'profesorId' como columna I (índice 8).
- Hallazgo: 'getAllExams' y 'getTeacherExamActivity' devuelven todos los exámenes/entregas. Deben filtrar por 'profesorId'.

[teacher-dashboard.html]
- Hallazgo: Faltan controles de interfaz para filtrar por Grado, Sección y Asignatura en la sección de Dashboard.

[js/teacher.js]
- Hallazgo: Las llamadas a 'fetchApi' para obtener actividad no envían el 'profesorId'.
- Hallazgo: Los formularios de creación de tareas y exámenes no incluyen el 'userId' del profesor.
- Hallazgo: 'applyFiltersAndSort' solo filtra por nombre de alumno, ignorando Grado, Sección y Asignatura.
