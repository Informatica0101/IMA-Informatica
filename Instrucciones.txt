Importante:
PROHIBIDO AGREGAR CONTENIDO ANTES DEL SIGUIENTE BLOQUE DE TEXTO.

— PROCEDIMIENTO OBLIGATORIO DE TRABAJO.
===================================================================

Este procedimiento es de CUMPLIMIENTO OBLIGATORIO en TODOS los proyectos.
No se permite omitir, alterar ni reordenar pasos.

--------------------------------------------------
FLUJO PRINCIPAL DE TRABAJO
--------------------------------------------------

1. AUDITORÍA INICIAL DEL ARCHIVO
   - Auditar el/los archivo(s) involucrados.
   - Revisión archivo por archivo.
   - Revisión línea por línea.
   - Identificar estado actual, riesgos, dependencias y efectos colaterales.
   - PROHIBIDO modificar código en esta etapa.

2. REGISTRO DE HALLAZGOS
   - Registrar TODOS los hallazgos en Auditoría.txt.
   - Crear nueva entrada o actualizar la existente.
   - PROHIBIDO eliminar información previa.
   - NO realizar correcciones durante la auditoría.

3. MANEJO DE HALLAZGOS FUERA DE ALCANCE
   - Si se detectan problemas fuera de la tarea actual:
     a) Resolverlos en el MISMO commit SOLO si es seguro.
     b) Si no es posible:
        -> Registrar nueva tarea en Instrucciones.txt
        -> Referenciarla en Auditoría.txt

4. RESPALDO OBLIGATORIO ANTES DE EDICIÓN
   - Crear copia exacta del/los archivo(s) a modificar.
   - El respaldo DEBE conservar:
     · Nombre original
     · Contenido íntegro
   - El respaldo se usa EXCLUSIVAMENTE para comparación posterior.

5. EJECUCIÓN DE LA TAREA
   - Implementar ÚNICAMENTE lo solicitado.
   - PROHIBIDO:
     · Cambiar estilos no relacionados
     · Alterar flujos existentes
     · Introducir optimizaciones no solicitadas
   - Todo cambio debe estar justificado por la tarea.

6. VERIFICACIÓN FUNCIONAL
   - Confirmar que la tarea cumple su objetivo.
   - Verificar que no se rompan funciones existentes.
   - Probar flujos relacionados directa e indirectamente.

7. COMPARACIÓN POST-EDICIÓN (OBLIGATORIA)
   - Comparar archivo editado contra el respaldo previo.
   - Identificar:
     · Líneas eliminadas
     · Líneas modificadas
     · Bloques sobreescritos
   - Verificar que:
     -> TODO cambio esté directamente relacionado con la tarea.
   - Si se detectan cambios ajenos:
     -> REVERTIRLOS inmediatamente
     -> Repetir la comparación
-Los archivos de Respaldo se debe eliminar DESPUES de la revision de codigo de Code Review.
-Todo archivo, captura generado para la verificación visual o ejecutable debe de ser eliminado en el pre-commit.

8. VERIFICACIÓN DE INTEGRIDAD Y EFECTOS COLATERALES
   - Revisar dependencias internas y externas.
   - Detectar efectos colaterales visuales o lógicos.
   - Confirmar que no existen regresiones.

9. REVISIÓN FINAL DE CÓDIGO
   - Revisar nuevamente el archivo completo modificado:
     - Línea por línea
     - Función por función
   - Validar coherencia, legibilidad y cumplimiento de reglas.

10. REGISTRO EN CHANGESLOGS.TXT
    - Registrar TODOS los cambios realizados.
    - Indicar:
      · Archivo modificado
      · Líneas afectadas
      · Descripción objetiva
    - PROHIBIDO asumir éxito o usar frases de cierre.

11. ACTUALIZACIÓN DE INSTRUCCIONES.TXT
    - Mover la tarea ejecutada a:
      -> "TAREAS PENDIENTES DE REVISIÓN"
tarea 28: Optimización visual del Dashboard del Profesor (Reducir márgenes, ajustar columnas, reposicionar buscador y botón regresar). (COMPLETADA)
    - NO eliminar tareas sin aprobación del PM.

12. COMMIT
    - Realizar UN SOLO commit por ciclo completo.
    - El commit DEBE reflejar EXACTAMENTE
      lo auditado y documentado.

-----------------------------------------------
EXTENSIÓN OBLIGATORIA POR CODE REVIEW
--------------------------------------------------

Si el Code Review detecta:
- Fallas
- Bloqueantes
- Riesgos
- Cambios requeridos

ENTONCES:
-> Este MISMO procedimiento DEBE aplicarse nuevamente
-> Incluso si implica modificar archivos ya editados
-> NO se permiten correcciones parciales


==================================================
PROTOCOLO DE RESULTADO DE CODE REVIEW
==================================================

--------------------------------------------------
FLUJO DE ANÁLISIS
--------------------------------------------------

1. LECTURA COMPLETA DEL CODE REVIEW
   - Leer TODO el informe.
   - No omitir secciones.

2. SAFETY & SIDE EFFECTS
   - Se considera FUENTE DE VERDAD PRINCIPAL.
   - SOLO se ignora si el Code Review solicita
     explícitamente revertir cambios.

--------------------------------------------------
TRATAMIENTO DE REVERSIÓN
--------------------------------------------------

3. EVALUACIÓN OBLIGATORIA

   a) CAMBIOS "OUT OF SCOPE"
      - Verificar si pertenecen a:
        · Tareas anteriores
        · Commits previos aprobados

      - Si pertenecen a tareas anteriores:
        -> IGNORAR solicitud de reversión
        -> CONTINUAR con el commit actual

   b) CAMBIOS DE LA TAREA ACTUAL
      - Si los cambios NO solicitados
        fueron introducidos durante la tarea actual:
        -> REALIZAR reversión
        -> REGISTRAR el motivo

--------------------------------------------------
IMPACTO EN EL FLUJO
--------------------------------------------------

4. REINICIO DEL CICLO
   - Toda observación que implique cambios:
     -> REINICIA el ciclo completo
        desde la AUDITORÍA INICIAL

   - El reinicio NO afecta:
     · Commits anteriores
     · Tareas aprobadas
     · Cambios fuera de alcance


--------------------------------------------------
DOCUMENTACIÓN OBLIGATORIA
--------------------------------------------------

Toda acción derivada del Code Review
DEBE quedar registrada en:
- Auditoría.txt
- ChangesLogs.txt
- Instrucciones.txt (si aplica)


--------------------------------------------------
REGLA FINAL ABSOLUTA
--------------------------------------------------

SI NO SE AUDITA, NO SE CAMBIA.
SI NO SE REGISTRA, NO EXISTE.

El incumplimiento de CUALQUIER paso
INVALIDA el proceso completo.

==================================================
TAREAS
=================================================

Despues de esta linea se deben de registrar las nuevas tareas, por realizar o completadas

________________________________________________________________________________________________
TAREAS COMPLETADAS (ÁREA PROTEGIDA - NO MODIFICAR)
________________________________________________________________________________________________
tarea 1: Implementar subida múltiple de imágenes una por una con vista previa y carga en segundo plano. (COMPLETADA)
tarea 2: Actualizar URL del microservicio TASK. (COMPLETADA)
tarea 3: Optimizar UX de carga en segundo plano (no bloqueante) y corregir backend. (COMPLETADA)
tarea 4: Actualización recurrente de la URL del microservicio TASK. (COMPLETADA)
tarea 5: Garantizar la integridad de subidas concurrentes en el dashboard del estudiante. (COMPLETADA)
tarea 6: Implementar animaciones de carga en todos los botones de envío al backend y corregir error de entrega de exámenes. (COMPLETADA)
tarea 7: Estandarizar formato de fechas a ISO 8601 en servicios de backend para corregir "Invalid Date" en el frontend. (COMPLETADA)
tarea 8: Auditar cambios finales, corregir variables obsoletas y aplicar nuevas URLs de servicios. (COMPLETADA)
tarea 10: Implementar búsqueda, filtrado y ordenamiento en el dashboard del profesor, restringir resultados de examen a estudiantes y habilitar calificación manual de exámenes. (COMPLETADA)
tarea 24: Reestructurar navegación del dashboard del profesor (Grados -> Sección -> Asignatura -> Alumno). (COMPLETADA)
tarea 25: Implementar vista de detalle del alumno con estados Completada/Pendiente/Por calificar. (COMPLETADA)
tarea 26: Implementar tabla de alumnos resumida con reordenamiento asc/desc. (COMPLETADA)
tarea 27: Implementar filtros avanzados en tabla de alumnos y conservar búsqueda global. (COMPLETADA)

TAREAS PENDIENTES DE REVISIÓN
tarea 28: Optimización visual del Dashboard del Profesor (Reducir márgenes, ajustar columnas, reposicionar buscador y botón regresar). (COMPLETADA)
tarea 29: Implementación de navegación directa sin botones, pestaña de exámenes, tablas responsivas, ajuste de tipografía y optimización de footer/hero. (COMPLETADA)
________________________________________________________________________________________________
tarea 9: Corregir lógica de renderizado de preguntas Verdadero/Falso y Término Pareado, y habilitar visualización detallada de resultados. (COMPLETADA)
tarea 11: Actualizar URLs de servicios, implementar ocultación de resultados de examen hasta revisión docente y estandarizar lógica de feedback en el dashboard del estudiante. (COMPLETADA)
tarea 12: Implementar restricción de acceso para profesores, mejorar legibilidad de IDs y lógica de visibilidad de secciones. (COMPLETADA)
tarea 13: Actualizar URLs de los microservicios TASK y EXAM a las nuevas implementaciones finales. (COMPLETADA)
tarea 14: Actualizar las URLs de producción definitivas para los microservicios USER, TASK y EXAM. (COMPLETADA)
tarea 15: Corregir fuga de aislamiento entre profesores y visualización de metadatos "N/A" en el dashboard docente. (COMPLETADA)
tarea 16: Actualizar URLs de producción para TASK y EXAM (...2Ss y ...8Kr). (COMPLETADA)
tarea 17: Implementar botón de instalación de PWA en menú móvil y pie de página y mejorar visibilidad. (COMPLETADA)
tarea 18: Implementar modal de login y sección de acceso (Portal/Iniciar Sesión) en index.html sin afectar secciones existentes. (COMPLETADA)
tarea 19: Unificación total de encabezados y pies de página, reducción de márgenes y gaps, y estandarización visual en dashboards y exámenes. (COMPLETADA)
tarea 20: Implementar navegación jerárquica y filtrado avanzado en el Dashboard del Profesor (navStack, filtros, títulos dinámicos). (COMPLETADA)
tarea 21: Optimizar accesibilidad móvil asegurando un área de toque mínima de 44px para todos los elementos interactivos. (COMPLETADA)
tarea 22: Corregir normalización de metadatos (grado vs gradoAsignado) en el dashboard del profesor para asegurar visibilidad de exámenes sin entregas en la jerarquía. (COMPLETADA)
tarea 23: Implementar limpieza automática del buscador al cambiar de nivel en la navegación jerárquica del dashboard docente. (COMPLETADA)

TAREAS PENDIENTES
________________________________________________________________________________________________

TAREA: [A-13]
ARCHIVO: js/teacher.js
UBICACIÓN: Función renderDetalles
ÁREA: Frontend / Lógica
PRIORIDAD: CRÍTICA

PROBLEMA A RESOLVER:
La variable 'index' no está definida en el callback de filtered.map, lo que rompe la funcionalidad de los botones de calificación en la vista de detalles.

ACCIONES REQUERIDAS:
- Modificar la línea de la función map para incluir el índice: filtered.map((item, index) => { ... })
- Asegurar que los botones grade-task-btn y grade-exam-btn reciban el valor correcto en data-index.

REGLAS:
- No introducir regresiones.
- Mantener compatibilidad móvil.

CRITERIO DE ACEPTACIÓN:
- Al hacer clic en "Calificar" desde la vista de detalles de un alumno, debe abrirse el modal de calificación con los datos correctos del ítem seleccionado.

--------------------------------------------------

TAREA: [A-14]
ARCHIVO: js/exam.js
UBICACIÓN: Archivo completo
ÁREA: Frontend / Lógica
PRIORIDAD: CRÍTICA

PROBLEMA A RESOLVER:
El archivo contiene comentarios de marcador de posición en lugar de código funcional para el temporizador y el modo pantalla completa.

ACCIONES REQUERIDAS:
- Restaurar la lógica funcional del temporizador (startTimer).
- Restaurar la lógica de pantalla completa (requestFullScreen) y sus protecciones contra salida accidental.

REGLAS:
- No modificar la lógica de envío de respuestas ya existente.

CRITERIO DE ACEPTACIÓN:
- El examen debe mostrar un temporizador funcional si el examen tiene un tiempo límite definido en la base de datos.
- El examen debe intentar entrar en pantalla completa al iniciar.

--------------------------------------------------

TAREA: [A-15]
ARCHIVO: js/exam.js
UBICACIÓN: Función submitExam
ÁREA: Frontend / Navegación
PRIORIDAD: MEDIA

PROBLEMA A RESOLVER:
Redirección a archivo inexistente 'student.html'.

ACCIONES REQUERIDAS:
- Cambiar window.location.href = 'student.html' por 'student-dashboard.html'.

REGLAS:
- Verificar que el archivo destino sea el correcto según la estructura del repo.

CRITERIO DE ACEPTACIÓN:
- Al terminar un examen bloqueado sin respuestas, el usuario debe ser redirigido correctamente al dashboard del estudiante.

--------------------------------------------------

TAREA: [A-16]
ARCHIVO: js/ui-common.js / js/index-ui.js
UBICACIÓN: Funciones de renderizado de navegación
ÁREA: Frontend / Arquitectura
PRIORIDAD: ALTA

PROBLEMA A RESOLVER:
La navegación móvil solo funciona en index.html porque renderMobileNav está en index-ui.js.

ACCIONES REQUERIDAS:
- Mover la función renderMobileNav de js/index-ui.js a js/ui-common.js.
- Asegurar que js/ui-common.js llame a renderMobileNav dentro de setupCommonUI o de forma que todas las páginas la ejecuten.
- Actualizar las llamadas en index-ui.js si es necesario.

REGLAS:
- Mantener la funcionalidad de los botones de acción (juegos) que se disparan desde el menú.

CRITERIO DE ACEPTACIÓN:
- El menú móvil debe mostrar las categorías de cursos y recursos adicionales correctamente en el dashboard del estudiante y el dashboard del profesor.

--------------------------------------------------

TAREA: [A-17]
ARCHIVO: exam-results.html
UBICACIÓN: Sección de scripts
ÁREA: Frontend / Estructura
PRIORIDAD: MEDIA

PROBLEMA A RESOLVER:
Falta de dependencias críticas y duplicidad con results.html.

ACCIONES REQUERIDAS:
- Opción A: Agregar <script src="js/config.js"></script> y <script src="js/api.js"></script> a exam-results.html.
- Opción B (Preferida): Unificar con results.html si cumplen la misma función y redirigir siempre a una sola.

REGLAS:
- No romper la visualización de resultados actuales.

CRITERIO DE ACEPTACIÓN:
- La página de resultados de examen debe cargar sin errores de "fetchApi is not defined" o similares.

--------------------------------------------------

TAREA: [A-18 y A-19]
ARCHIVO: js/teacher.js / js/main.js
UBICACIÓN: Event listeners y archivos raíz
ÁREA: Mantenibilidad
PRIORIDAD: BAJA

PROBLEMA A RESOLVER:
Código muerto y archivos redundantes.

ACCIONES REQUERIDAS:
- Eliminar los bloques de código en js/teacher.js que manejan 'view-results-btn' y 'reactivate-exam-btn'.
- Eliminar el archivo js/main.js.

REGLAS:
- Asegurarse de que no existan dependencias ocultas a js/main.js en ningún HTML.

CRITERIO DE ACEPTACIÓN:
- El sitio debe seguir funcionando correctamente sin js/main.js.
- El código de teacher.js debe estar más limpio.

--------------------------------------------------

TAREA: [A-20]
ARCHIVO: Varios (Contenido Educativo)
UBICACIÓN: Enlaces y Assets
ÁREA: SEO / Navegación
PRIORIDAD: MEDIA

PROBLEMA A RESOLVER:
Enlaces rotos o desactualizados apuntando a azghell.github.io.

ACCIONES REQUERIDAS:
- Realizar un reemplazo global de 'https://azghell.github.io/IMA-Informatica' por 'https://informatica0101.github.io' en todos los archivos HTML de las carpetas de grados.

REGLAS:
- Solo modificar la URL base, mantener el resto de la ruta.

CRITERIO DE ACEPTACIÓN:
- Los botones de "Inicio" en las presentaciones deben llevar a la URL correcta del portal.

--------------------------------------------------

TAREA: [A-21]
ARCHIVO: js/data.js
UBICACIÓN: presentationData
ÁREA: Visual
PRIORIDAD: BAJA

PROBLEMA A RESOLVER:
Erratas en etiquetas de datos.

ACCIONES REQUERIDAS:
- Cambiar "Grind vs Flexbox" por "Grid vs Flexbox".
- Corregir cualquier otra errata evidente en los títulos de temas.

REGLAS:
- No modificar las rutas de los archivos (propiedad 'file'), solo los títulos visibles.

CRITERIO DE ACEPTACIÓN:
- El menú de cursos debe mostrar "Grid vs Flexbox".

--------------------------------------------------

TAREA: [A-22]
ARCHIVO: js/student.js
UBICACIÓN: Modal de entrega
ÁREA: UX
PRIORIDAD: MEDIA

PROBLEMA A RESOLVER:
Imposibilidad de eliminar un archivo subido por error antes de la entrega final.

ACCIONES REQUERIDAS:
- Agregar un botón de "Eliminar" (X) a cada elemento de la lista de archivos subidos en el modal.
- Implementar la lógica para remover el archivo del array uploadedFiles al hacer clic.

REGLAS:
- El botón debe ser accesible y visible.

CRITERIO DE ACEPTACIÓN:
- El estudiante puede subir 3 archivos, eliminar el segundo, y entregar solo los 2 restantes correctamente.

--------------------------------------------------

TAREA: [A-23]
ARCHIVO: backend.gs
UBICACIÓN: Raíz del proyecto
ÁREA: Backend / Mantenibilidad
PRIORIDAD: BAJA

PROBLEMA A RESOLVER:
Archivo redundante y legado que no forma parte de la arquitectura de microservicios actual.

ACCIONES REQUERIDAS:
- Eliminar el archivo backend.gs de la raíz del proyecto.

REGLAS:
- Ninguna.

CRITERIO DE ACEPTACIÓN:
- El archivo ya no existe en el repositorio. El sistema (que usa SERVICE_URLS individuales) sigue funcionando.

--------------------------------------------------
